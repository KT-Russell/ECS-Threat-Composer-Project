"use strict";(self.webpackChunk_aws_threat_composer=self.webpackChunk_aws_threat_composer||[]).push([[5717],{"./src/components/generic/STRIDESelector/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,l:()=>OPTIONS});var _cloudscape_design_components_form_field__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/@cloudscape-design/components/form-field/index.js"),_cloudscape_design_components_multiselect__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@cloudscape-design/components/multiselect/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const OPTIONS=[{label:"Spoofing",value:"S"},{label:"Tampering",value:"T"},{label:"Repudiation",value:"R"},{label:"Information disclosure",value:"I"},{label:"Denial of service",value:"D"},{label:"Elevation of privilege",value:"E"}],STRIDESelector=({label,selected,setSelected})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_cloudscape_design_components_form_field__WEBPACK_IMPORTED_MODULE_1__.A,{label,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_cloudscape_design_components_multiselect__WEBPACK_IMPORTED_MODULE_2__.A,{selectedOptions:selected?OPTIONS.filter((x=>selected.includes(x.value))):[],onChange:({detail})=>setSelected(detail.selectedOptions.map((x=>x.value||""))),options:OPTIONS,selectedAriaLabel:"Selected"})});STRIDESelector.displayName="STRIDESelector";const __WEBPACK_DEFAULT_EXPORT__=STRIDESelector;try{STRIDESelector.displayName="STRIDESelector",STRIDESelector.__docgenInfo={description:"",displayName:"STRIDESelector",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},selected:{defaultValue:null,description:"",name:"selected",required:!1,type:{name:"string[]"}},setSelected:{defaultValue:null,description:"",name:"setSelected",required:!0,type:{name:"(value: string[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/STRIDESelector/index.tsx#STRIDESelector"]={docgenInfo:STRIDESelector.__docgenInfo,name:"STRIDESelector",path:"src/components/generic/STRIDESelector/index.tsx#STRIDESelector"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/generic/Table/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>generic_Table});var collection_preferences=__webpack_require__("../../node_modules/@cloudscape-design/components/collection-preferences/index.js"),react=__webpack_require__("../../node_modules/react/index.js"),use_collection=__webpack_require__("../../node_modules/@cloudscape-design/collection-hooks/mjs/use-collection.js"),components_button=__webpack_require__("../../node_modules/@cloudscape-design/components/button/index.js"),pagination=__webpack_require__("../../node_modules/@cloudscape-design/components/pagination/index.js"),table=__webpack_require__("../../node_modules/@cloudscape-design/components/table/index.js"),text_filter=__webpack_require__("../../node_modules/@cloudscape-design/components/text-filter/index.js");const config_getAriaLabels=(trackBy="id")=>({selectionGroupLabel:"Items selection",allItemsSelectionLabel:({selectedItems})=>`${selectedItems.length} ${1===selectedItems.length?"item":"items"} selected`,itemSelectionLabel:({selectedItems},item)=>{const isItemSelected=selectedItems.filter((i=>i[trackBy]===item[trackBy])).length;return`${item.name} is ${isItemSelected?"":"not"} selected`}}),DEFAULT_PAGE_SIZE_OPTIONS=[{value:10,label:"10 rows"},{value:30,label:"30 rows"},{value:50,label:"50 rows"}],DEFAULT_PAGINATION_LABELS={nextPageLabel:"Next page",previousPageLabel:"Previous page",pageLabel:pageNumber=>`Page ${pageNumber} of all pages`};var box=__webpack_require__("../../node_modules/@cloudscape-design/components/box/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const EmptyState=({title,subtitle,action})=>(0,jsx_runtime.jsxs)(box.A,{textAlign:"center",color:"inherit",children:[(0,jsx_runtime.jsx)(box.A,{variant:"strong",textAlign:"center",color:"inherit",children:title}),(0,jsx_runtime.jsx)(box.A,{variant:"p",padding:{bottom:"s"},color:"inherit",children:subtitle}),action]});EmptyState.displayName="EmptyState";const components_EmptyState=EmptyState;try{EmptyState.displayName="EmptyState",EmptyState.__docgenInfo={description:"",displayName:"EmptyState",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!0,type:{name:"string"}},action:{defaultValue:null,description:"",name:"action",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Table/components/EmptyState/index.tsx#EmptyState"]={docgenInfo:EmptyState.__docgenInfo,name:"EmptyState",path:"src/components/generic/Table/components/EmptyState/index.tsx#EmptyState"})}catch(__react_docgen_typescript_loader_error){}var header=__webpack_require__("../../node_modules/@cloudscape-design/components/header/index.js");const CloudscapeHeaderType=(0,react.createElement)(header.A).type,Header=({selectedItemsLength,allItemsLength,children,actions,info,description,variant})=>{const customHeader=(0,react.isValidElement)(children)&&children.type===CloudscapeHeaderType,counter=(0,react.useMemo)((()=>allItemsLength?selectedItemsLength?`(${selectedItemsLength}/${allItemsLength})`:`(${allItemsLength})`:void 0),[allItemsLength,selectedItemsLength]);return customHeader?children:(0,jsx_runtime.jsx)(header.A,{counter,info,actions,description,variant,children})},components_Header=Header;try{Header.displayName="Header",Header.__docgenInfo={description:"",displayName:"Header",props:{actions:{defaultValue:null,description:"",name:"actions",required:!1,type:{name:"ReactNode"}},info:{defaultValue:null,description:"",name:"info",required:!1,type:{name:"ReactNode"}},variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"h1"'},{value:'"h2"'},{value:'"h3"'},{value:'"awsui-h1-sticky"'}]}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"ReactNode"}},allItemsLength:{defaultValue:null,description:"",name:"allItemsLength",required:!1,type:{name:"number"}},selectedItemsLength:{defaultValue:null,description:"",name:"selectedItemsLength",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Table/components/Header/index.tsx#Header"]={docgenInfo:Header.__docgenInfo,name:"Header",path:"src/components/generic/Table/components/Header/index.tsx#Header"})}catch(__react_docgen_typescript_loader_error){}const FullDataTable=({ariaLabels,columnDefinitions,items:allItems,disablePagination=!1,pagination:paginationComponent,disableSettings=!1,preferences:collectionPreferenceComponent,disableFilters=!1,disableRowSelect=!1,selectionType="multi",filter:filterComponent,selectedItems,header,trackBy="id",collectionPreferences,onSelectionChange,defaultPageIndex,...props})=>{const{items,actions,collectionProps,filterProps,paginationProps}=(0,use_collection.G)(allItems,{filtering:{empty:(0,jsx_runtime.jsx)(components_EmptyState,{title:"No items",subtitle:"No items to display."}),noMatch:(0,jsx_runtime.jsx)(components_EmptyState,{title:"No matches",subtitle:"We canâ€™t find a match.",action:(0,jsx_runtime.jsx)(components_button.A,{onClick:()=>actions.setFiltering(""),children:"Clear filter"})})},pagination:{pageSize:collectionPreferences.pageSize,defaultPage:defaultPageIndex},sorting:{defaultState:{sortingColumn:columnDefinitions[0]}},selection:{defaultSelectedItems:selectedItems,trackBy}});(0,react.useEffect)((()=>{actions.setSelectedItems(selectedItems||[])}),[selectedItems,paginationProps.currentPageIndex,filterProps.filteringText]);const collectionPropsOnSelectionChange=collectionProps.onSelectionChange,handleSelectionChange=(0,react.useCallback)((event=>{onSelectionChange?.(event),collectionPropsOnSelectionChange?.(event)}),[onSelectionChange,collectionPropsOnSelectionChange]);return(0,jsx_runtime.jsx)(table.A,{trackBy,loadingText:"Loading",columnDisplay:collectionPreferences.contentDisplay,wrapLines:collectionPreferences.wrapLines,stripedRows:collectionPreferences.stripedRows,...props,...collectionProps,onSelectionChange:handleSelectionChange,selectionType:!disableRowSelect&&selectionType||void 0,ariaLabels:ariaLabels||config_getAriaLabels(),columnDefinitions,items:items||[],pagination:!disablePagination&&(paginationComponent??(0,jsx_runtime.jsx)(pagination.A,{...paginationProps,ariaLabels:DEFAULT_PAGINATION_LABELS})),preferences:collectionPreferenceComponent,filter:!disableFilters&&(filterComponent??(0,jsx_runtime.jsx)(text_filter.A,{...filterProps,filteringPlaceholder:"Search",filteringAriaLabel:"Filter table content"})),header:header&&(0,jsx_runtime.jsx)(components_Header,{actions:props.actions,info:props.info,variant:props.headerVariant,description:props.description,allItemsLength:allItems.length,selectedItemsLength:collectionProps?.selectedItems?.length,children:header})})};FullDataTable.displayName="FullDataTable";const components_FullDataTable=FullDataTable;try{FullDataTable.displayName="FullDataTable",FullDataTable.__docgenInfo={description:"",displayName:"FullDataTable",props:{disablePagination:{defaultValue:{value:"false"},description:"Disable pagination",name:"disablePagination",required:!1,type:{name:"boolean"}},disableSettings:{defaultValue:{value:"false"},description:"Disable preference toolbar",name:"disableSettings",required:!1,type:{name:"boolean"}},disableFilters:{defaultValue:{value:"false"},description:"Disable search filters",name:"disableFilters",required:!1,type:{name:"boolean"}},disableRowSelect:{defaultValue:{value:"false"},description:"Disable row select",name:"disableRowSelect",required:!1,type:{name:"boolean"}},collectionPreferencesProps:{defaultValue:null,description:"Options for page size in collection preferences.",name:"collectionPreferencesProps",required:!1,type:{name:"Partial<CollectionPreferencesProps<any>>"}},defaultPageSize:{defaultValue:null,description:"The default number of rows on any given page",name:"defaultPageSize",required:!1,type:{name:"number"}},defaultPageIndex:{defaultValue:null,description:"The default index of the page that should be displayed",name:"defaultPageIndex",required:!1,type:{name:"number"}},header:{defaultValue:null,description:"The heading text (together with actions, info and description props to form a Table header) <br/>\nor the Cloudscape header component.",name:"header",required:!1,type:{name:"ReactNode"}},headerVariant:{defaultValue:null,description:"The variant of the table header.",name:"headerVariant",required:!1,type:{name:"enum",value:[{value:'"h1"'},{value:'"h2"'},{value:'"h3"'},{value:'"awsui-h1-sticky"'}]}},collectionPreferences:{defaultValue:null,description:"",name:"collectionPreferences",required:!0,type:{name:"Preferences<any>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Table/components/FullDataTable/index.tsx#FullDataTable"]={docgenInfo:FullDataTable.__docgenInfo,name:"FullDataTable",path:"src/components/generic/Table/components/FullDataTable/index.tsx#FullDataTable"})}catch(__react_docgen_typescript_loader_error){}const Table=({disableSettings,preferences:collectionPreferenceComponent,...props})=>{const[preferences,setPreferences]=(0,react.useState)({pageSize:props.defaultPageSize,visibleContent:props.columnDefinitions.map((cd=>cd.id||"")),wrapLines:!0,stripedRows:!0}),visibleContentOptions=(0,react.useMemo)((()=>[{label:"Main properties",options:props.columnDefinitions.map((cd=>({id:cd.id||"",label:("string"==typeof cd.header?cd.header:cd.id)||""})))}]),[props.columnDefinitions]),handlePreferenceChange=(0,react.useCallback)((({detail})=>{setPreferences(detail)}),[]),preferenceComponent=(0,react.useMemo)((()=>{if(!disableSettings)return collectionPreferenceComponent||(0,jsx_runtime.jsx)(collection_preferences.A,{title:"Preferences",confirmLabel:"Confirm",cancelLabel:"Cancel",pageSizePreference:{title:"Page size",options:DEFAULT_PAGE_SIZE_OPTIONS},wrapLinesPreference:{label:"Wrap lines",description:"Check to see all the text and wrap the lines"},stripedRowsPreference:{label:"Striped rows",description:"Check to add alternating shaded rows"},visibleContentPreference:{title:"Select visible columns",options:visibleContentOptions},preferences,onConfirm:handlePreferenceChange,...props.collectionPreferencesProps})}),[disableSettings,preferences,props.collectionPreferencesProps,collectionPreferenceComponent,visibleContentOptions,handlePreferenceChange]);return(0,jsx_runtime.jsx)(components_FullDataTable,{...props,collectionPreferences:preferences,preferences:preferenceComponent})};Table.displayName="Table";const generic_Table=Table;try{Table.displayName="Table",Table.__docgenInfo={description:"A table presents data in a two-dimensional format, arranged in columns and rows in a rectangular form.",displayName:"Table",props:{disablePagination:{defaultValue:null,description:"Disable pagination",name:"disablePagination",required:!1,type:{name:"boolean"}},disableSettings:{defaultValue:null,description:"Disable preference toolbar",name:"disableSettings",required:!1,type:{name:"boolean"}},disableFilters:{defaultValue:null,description:"Disable search filters",name:"disableFilters",required:!1,type:{name:"boolean"}},disableRowSelect:{defaultValue:null,description:"Disable row select",name:"disableRowSelect",required:!1,type:{name:"boolean"}},collectionPreferencesProps:{defaultValue:null,description:"Options for page size in collection preferences.",name:"collectionPreferencesProps",required:!1,type:{name:"Partial<CollectionPreferencesProps<any>>"}},defaultPageSize:{defaultValue:null,description:"The default number of rows on any given page",name:"defaultPageSize",required:!1,type:{name:"number"}},defaultPageIndex:{defaultValue:null,description:"The default index of the page that should be displayed",name:"defaultPageIndex",required:!1,type:{name:"number"}},header:{defaultValue:null,description:"The heading text (together with actions, info and description props to form a Table header) <br/>\nor the Cloudscape header component.",name:"header",required:!1,type:{name:"ReactNode"}},headerVariant:{defaultValue:null,description:"The variant of the table header.",name:"headerVariant",required:!1,type:{name:"enum",value:[{value:'"h1"'},{value:'"h2"'},{value:'"h3"'},{value:'"awsui-h1-sticky"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Table/index.tsx#Table"]={docgenInfo:Table.__docgenInfo,name:"Table",path:"src/components/generic/Table/index.tsx#Table"})}catch(__react_docgen_typescript_loader_error){}try{DEFAULT_TRACK_BY.displayName="DEFAULT_TRACK_BY",DEFAULT_TRACK_BY.__docgenInfo={description:'*******************************************************************************************************************\nCopyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the "License").\nYou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n  http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*******************************************************************************************************************',displayName:"DEFAULT_TRACK_BY",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Table/index.tsx#DEFAULT_TRACK_BY"]={docgenInfo:DEFAULT_TRACK_BY.__docgenInfo,name:"DEFAULT_TRACK_BY",path:"src/components/generic/Table/index.tsx#DEFAULT_TRACK_BY"})}catch(__react_docgen_typescript_loader_error){}try{getAriaLabels.displayName="getAriaLabels",getAriaLabels.__docgenInfo={description:"",displayName:"getAriaLabels",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Table/index.tsx#getAriaLabels"]={docgenInfo:getAriaLabels.__docgenInfo,name:"getAriaLabels",path:"src/components/generic/Table/index.tsx#getAriaLabels"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/generic/Textarea/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components_form_field__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@cloudscape-design/components/form-field/index.js"),_cloudscape_design_components_textarea__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/@cloudscape-design/components/textarea/index.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_hooks_useContentValidation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/hooks/useContentValidation/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const Textarea=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((({value,onChange,validateData,singleLine,...props},ref)=>{const{tempValue,errorText,handleChange}=(0,_hooks_useContentValidation__WEBPACK_IMPORTED_MODULE_1__.A)(value,onChange,validateData),handleValueChange=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((event=>handleChange(singleLine?{...event,detail:{...event.detail,value:event.detail.value.replace(/\n|\r/i," ")}}:event)),[singleLine,handleChange]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_cloudscape_design_components_form_field__WEBPACK_IMPORTED_MODULE_3__.A,{...props,errorText,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_cloudscape_design_components_textarea__WEBPACK_IMPORTED_MODULE_4__.A,{...props,ref,value:tempValue,onChange:handleValueChange})})})),__WEBPACK_DEFAULT_EXPORT__=Textarea;try{Textarea.displayName="Textarea",Textarea.__docgenInfo={description:"",displayName:"Textarea",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"LegacyRef<any>"}},validateData:{defaultValue:null,description:"",name:"validateData",required:!1,type:{name:"((newValue: string) => ZodSafeParseResult<string>)"}},singleLine:{defaultValue:null,description:"",name:"singleLine",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Textarea/index.tsx#Textarea"]={docgenInfo:Textarea.__docgenInfo,name:"Textarea",path:"src/components/generic/Textarea/index.tsx#Textarea"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/mitigations/MitigationLinkView/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@cloudscape-design/components/space-between/index.js"),_cloudscape_design_components_autosuggest__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/@cloudscape-design/components/autosuggest/index.js"),_cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@cloudscape-design/components/expandable-section/index.js"),_cloudscape_design_components_token_group__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/@cloudscape-design/components/token-group/index.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const MitigationLinkComponent=({variant,linkedMitigationIds,mitigationList,onAddMitigationLink,onRemoveMitigationLink,children})=>{const[searchValue,setSearchValue]=react__WEBPACK_IMPORTED_MODULE_0__.useState(""),linkedMitigations=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>mitigationList.filter((al=>linkedMitigationIds.includes(al.id)))),[linkedMitigationIds,mitigationList]),filteredMitigations=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>{const mitigations=mitigationList.filter((x=>!linkedMitigationIds.includes(x.id)));return searchValue?mitigations.filter((x=>x.content.toLowerCase().indexOf(searchValue.toLowerCase())>=0)):mitigations}),[searchValue,mitigationList,linkedMitigationIds]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_2__.A,{variant,headingTagOverride:"container"===variant?"h3":void 0,headerText:`Linked mitigations (${linkedMitigations.length})`,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(_cloudscape_design_components__WEBPACK_IMPORTED_MODULE_3__.A,{direction:"vertical",size:"l",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_autosuggest__WEBPACK_IMPORTED_MODULE_4__.A,{onChange:({detail})=>setSearchValue(detail.value),value:searchValue,options:filteredMitigations.map((x=>({value:x.id,label:x.content}))),onSelect:({detail})=>{onAddMitigationLink(detail.value),setSearchValue("")},filteringType:"manual",enteredTextLabel:value=>`Add new mitigation: "${value}"`,placeholder:"Search mitigation",empty:"No matches found"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{style:{display:"flex"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_token_group__WEBPACK_IMPORTED_MODULE_5__.A,{items:linkedMitigations.map((x=>({label:x.content,dismissLabel:`Unlink mitigation ${x.numericId}`}))),onDismiss:({detail:{itemIndex}})=>{onRemoveMitigationLink(linkedMitigations[itemIndex].id)}})})]}),children]})})};MitigationLinkComponent.displayName="MitigationLinkComponent";const __WEBPACK_DEFAULT_EXPORT__=MitigationLinkComponent;try{MitigationLinkView.displayName="MitigationLinkView",MitigationLinkView.__docgenInfo={description:"",displayName:"MitigationLinkView",props:{variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"footer"'},{value:'"container"'},{value:'"stacked"'},{value:'"navigation"'},{value:'"inline"'}]}},linkedMitigationIds:{defaultValue:null,description:"",name:"linkedMitigationIds",required:!0,type:{name:"string[]"}},mitigationList:{defaultValue:null,description:"",name:"mitigationList",required:!0,type:{name:'{ id: string; numericId: number; content: string; displayOrder?: number | undefined; tags?: string[] | undefined; metadata?: ({ key: "Comments"; value: string; } | { key: string; value: string | string[]; } | { ...; } | { ...; } | { ...; })[] | undefined; status?: string | undefined; }[]'}},onAddMitigationLink:{defaultValue:null,description:"",name:"onAddMitigationLink",required:!0,type:{name:"(mitigationId: string) => void"}},onRemoveMitigationLink:{defaultValue:null,description:"",name:"onRemoveMitigationLink",required:!0,type:{name:"(mitigationId: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/mitigations/MitigationLinkView/index.tsx#MitigationLinkView"]={docgenInfo:MitigationLinkView.__docgenInfo,name:"MitigationLinkView",path:"src/components/mitigations/MitigationLinkView/index.tsx#MitigationLinkView"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/threats/MetadataEditor/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/@cloudscape-design/components/expandable-section/index.js"),_cloudscape_design_components_grid__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/@cloudscape-design/components/grid/index.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_data_status_threatStatus_json__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/data/status/threatStatus.json"),_styles_expandablePanelHeader__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/styles/expandablePanelHeader.ts"),_generic_CommentsEdit__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/generic/CommentsEdit/index.tsx"),_generic_StatusSelector__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/generic/StatusSelector/index.tsx"),_generic_STRIDESelector__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/generic/STRIDESelector/index.tsx"),_PriorityEdit__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/components/threats/PriorityEdit/index.tsx"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const MetadataEditor=({variant,editingStatement,onEditStatementStatus,onEditMetadata})=>{const[expanded,setExpanded]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),stride=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>editingStatement.metadata?.find((m=>"STRIDE"===m.key))?.value||void 0),[editingStatement.metadata]);return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Y)(_cloudscape_design_components_expandable_section__WEBPACK_IMPORTED_MODULE_8__.A,{headerText:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Y)("span",{css:"default"===variant?_styles_expandablePanelHeader__WEBPACK_IMPORTED_MODULE_2__.A:void 0,children:"Metadata"}),headingTagOverride:"h3",variant,expanded,onChange:({detail})=>setExpanded(detail.expanded),children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.FD)(_cloudscape_design_components_grid__WEBPACK_IMPORTED_MODULE_9__.A,{gridDefinition:[{colspan:{default:12,xs:3}},{colspan:{default:12,xs:3}},{colspan:{default:12,xs:6}},...expanded?[{colspan:{default:12,xs:12}}]:[]],children:[(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Y)(_generic_StatusSelector__WEBPACK_IMPORTED_MODULE_4__.A,{selectedOption:editingStatement.status,setSelectedOption:option=>onEditStatementStatus(editingStatement,option),options:_data_status_threatStatus_json__WEBPACK_IMPORTED_MODULE_1__}),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Y)(_PriorityEdit__WEBPACK_IMPORTED_MODULE_6__.A,{editingStatement,onEditMetadata}),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Y)(_generic_STRIDESelector__WEBPACK_IMPORTED_MODULE_5__.A,{label:"STRIDE",selected:stride,setSelected:selected=>onEditMetadata(editingStatement,"STRIDE",selected)}),expanded&&(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Y)(_generic_CommentsEdit__WEBPACK_IMPORTED_MODULE_3__.A,{entity:editingStatement,onEditEntity:onEditMetadata})]})})};MetadataEditor.displayName="MetadataEditor";const __WEBPACK_DEFAULT_EXPORT__=MetadataEditor;try{MetadataEditor.displayName="MetadataEditor",MetadataEditor.__docgenInfo={description:"",displayName:"MetadataEditor",props:{variant:{defaultValue:null,description:"",name:"variant",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"default"'},{value:'"footer"'},{value:'"container"'},{value:'"stacked"'},{value:'"navigation"'},{value:'"inline"'}]}},editingStatement:{defaultValue:null,description:"",name:"editingStatement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},onEditStatementStatus:{defaultValue:null,description:"",name:"onEditStatementStatus",required:!0,type:{name:"(statement: { id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }, status: string) => void"}},onEditMetadata:{defaultValue:null,description:"",name:"onEditMetadata",required:!0,type:{name:"(statement: { id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }, key: string, value: string | ... 1 more ... | undefine..."}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/MetadataEditor/index.tsx#MetadataEditor"]={docgenInfo:MetadataEditor.__docgenInfo,name:"MetadataEditor",path:"src/components/threats/MetadataEditor/index.tsx#MetadataEditor"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/threats/PriorityEdit/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>threats_PriorityEdit});var react=__webpack_require__("../../node_modules/react/index.js"),form_field=__webpack_require__("../../node_modules/@cloudscape-design/components/form-field/index.js"),components_select=__webpack_require__("../../node_modules/@cloudscape-design/components/select/index.js"),configs=__webpack_require__("./src/configs/index.ts"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const LevelSelector=react.forwardRef((({label,selectedLevel,setSelectedLevel,allowNoValue,placeholder,onFocus,onBlur},ref)=>(0,jsx_runtime.jsx)(form_field.A,{label,children:(0,jsx_runtime.jsx)(components_select.A,{ref,selectedOption:configs.cc.find((x=>x.value===selectedLevel))||null,onChange:({detail})=>{const selected=detail.selectedOption.value;setSelectedLevel?.(selected&&"-"!==selected?selected:void 0)},options:allowNoValue?[{label:"-",value:"-"},...configs.cc]:configs.cc,selectedAriaLabel:"Selected",onFocus,onBlur,expandToViewport:!0,placeholder})}))),generic_LevelSelector=LevelSelector;try{LevelSelector.displayName="LevelSelector",LevelSelector.__docgenInfo={description:"",displayName:"LevelSelector",props:{label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"string"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},selectedLevel:{defaultValue:null,description:"",name:"selectedLevel",required:!1,type:{name:"string"}},setSelectedLevel:{defaultValue:null,description:"",name:"setSelectedLevel",required:!1,type:{name:"((level: string) => void)"}},allowNoValue:{defaultValue:null,description:"",name:"allowNoValue",required:!1,type:{name:"boolean"}},onFocus:{defaultValue:null,description:"",name:"onFocus",required:!1,type:{name:"(() => void)"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!1,type:{name:"(() => void)"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"LegacyRef<Ref>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/LevelSelector/index.tsx#LevelSelector"]={docgenInfo:LevelSelector.__docgenInfo,name:"LevelSelector",path:"src/components/generic/LevelSelector/index.tsx#LevelSelector"})}catch(__react_docgen_typescript_loader_error){}const PriorityEdit=react.forwardRef((({editingStatement,onEditMetadata,showLabel=!0,...props},ref)=>{const priority=(0,react.useMemo)((()=>editingStatement.metadata?.find((m=>"Priority"===m.key))?.value||void 0),[editingStatement.metadata]);return(0,jsx_runtime.jsx)(generic_LevelSelector,{ref,...props,allowNoValue:!0,placeholder:"Select Priority",label:showLabel?"Priority":void 0,selectedLevel:priority,setSelectedLevel:selectedLevel=>onEditMetadata(editingStatement,"Priority",selectedLevel)})})),threats_PriorityEdit=PriorityEdit;try{PriorityEdit.displayName="PriorityEdit",PriorityEdit.__docgenInfo={description:"",displayName:"PriorityEdit",props:{showLabel:{defaultValue:{value:"true"},description:"",name:"showLabel",required:!1,type:{name:"boolean"}},editingStatement:{defaultValue:null,description:"",name:"editingStatement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},onEditMetadata:{defaultValue:null,description:"",name:"onEditMetadata",required:!0,type:{name:"(statement: { id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }, key: string, value: string | ... 1 more ... | undefine..."}},onFocus:{defaultValue:null,description:"",name:"onFocus",required:!1,type:{name:"(() => void)"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!1,type:{name:"(() => void)"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"LegacyRef<any>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/PriorityEdit/index.tsx#PriorityEdit"]={docgenInfo:PriorityEdit.__docgenInfo,name:"PriorityEdit",path:"src/components/threats/PriorityEdit/index.tsx#PriorityEdit"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/threats/ThreatStatementEditor/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>ThreatStatementEditorInner,A:()=>threats_ThreatStatementEditor});var content_layout=__webpack_require__("../../node_modules/@cloudscape-design/components/content-layout/index.js"),grid=__webpack_require__("../../node_modules/@cloudscape-design/components/grid/index.js"),space_between=__webpack_require__("../../node_modules/@cloudscape-design/components/space-between/index.js"),text_content=__webpack_require__("../../node_modules/@cloudscape-design/components/text-content/index.js"),design_tokens=__webpack_require__("../../node_modules/@cloudscape-design/design-tokens/index.js"),emotion_react_browser_esm=__webpack_require__("../../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),react=__webpack_require__("../../node_modules/react/index.js"),configs=__webpack_require__("./src/configs/index.ts"),constants=__webpack_require__("./src/configs/constants.ts"),context=__webpack_require__("./src/contexts/AssumptionLinksContext/context.ts"),AssumptionsContext_context=__webpack_require__("./src/contexts/AssumptionsContext/context.ts"),GlobalSetupContext_context=__webpack_require__("./src/contexts/GlobalSetupContext/context.ts"),MitigationLinksContext_context=__webpack_require__("./src/contexts/MitigationLinksContext/context.ts"),MitigationsContext_context=__webpack_require__("./src/contexts/MitigationsContext/context.ts"),ThreatsContext_context=__webpack_require__("./src/contexts/ThreatsContext/context.ts"),WorkspacesContext_context=__webpack_require__("./src/contexts/WorkspacesContext/context.ts"),threatFieldData=__webpack_require__("./src/data/threatFieldData.ts"),threatStatementExamples=__webpack_require__("./src/data/threatStatementExamples.json"),threatStatementFormat=__webpack_require__("./src/data/threatStatementFormat.ts"),useEditMetadata=__webpack_require__("./src/hooks/useEditMetadata/index.ts"),getMetadata=__webpack_require__("./src/utils/getMetadata/index.ts"),getNewMitigation=__webpack_require__("./src/utils/getNewMitigation/index.tsx"),getNewThreatStatement=__webpack_require__("./src/utils/getNewThreatStatement/index.tsx"),customTypes=__webpack_require__("./src/customTypes/index.ts"),calculateFieldCombination=__webpack_require__("./src/utils/calculateFieldCombination/index.ts");const allFields=Object.keys(customTypes.TK),getRecommandedEditor=statement=>{if(statement){const{fieldCombination,filledField}=(0,calculateFieldCombination.A)(statement);if(0!==fieldCombination){const unFilledFields=allFields.filter((af=>!filledField.includes(af))),unFilledFieldsLen=unFilledFields.length;if(1===unFilledFieldsLen)return unFilledFields[0];if(unFilledFieldsLen>1){return unFilledFields[Math.floor(Math.random()*unFilledFieldsLen)]}const randomFieldNum=Math.floor(Math.random()*filledField.length);return filledField[randomFieldNum]}}},utils_matchThreatPackMitigationCandidate=(mitigation,threatPackId,mitigationCandiateId)=>{const metadata=(0,getMetadata.A)(mitigation.metadata);return metadata[configs.s7]===configs.jU&&metadata[configs.jU]===threatPackId&&metadata[configs.FY]===mitigationCandiateId};var renderThreatStatement=__webpack_require__("./src/utils/renderThreatStatement/index.ts");const utils_scrollToTop=()=>{window.scrollTo({top:0,behavior:"smooth"})};var AssumptionLinkView=__webpack_require__("./src/components/assumptions/AssumptionLinkView/index.tsx"),Tooltip=__webpack_require__("./src/components/generic/Tooltip/index.tsx"),MitigationLinkView=__webpack_require__("./src/components/mitigations/MitigationLinkView/index.tsx"),components_alert=__webpack_require__("../../node_modules/@cloudscape-design/components/alert/index.js"),box=__webpack_require__("../../node_modules/@cloudscape-design/components/box/index.js"),components_button=__webpack_require__("../../node_modules/@cloudscape-design/components/button/index.js"),header=__webpack_require__("../../node_modules/@cloudscape-design/components/header/index.js"),modal=__webpack_require__("../../node_modules/@cloudscape-design/components/modal/index.js"),Textarea=__webpack_require__("./src/components/generic/Textarea/index.tsx"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const CustomTemplate=({visible,setVisible,statement,defaultTemplate,onConfirm})=>{const[value,setValue]=(0,react.useState)(statement?.customTemplate||defaultTemplate),renderedStatement=(0,react.useMemo)((()=>{const{statement:updatedStatement}=(0,renderThreatStatement.A)({...statement,customTemplate:value===defaultTemplate?void 0:value});return updatedStatement}),[statement,value,defaultTemplate]),footer=(0,react.useMemo)((()=>(0,jsx_runtime.jsx)(box.A,{float:"right",children:(0,jsx_runtime.jsxs)(space_between.A,{direction:"horizontal",size:"xs",children:[(0,jsx_runtime.jsx)(components_button.A,{variant:"link",onClick:()=>setVisible(!1),children:"Cancel"}),(0,jsx_runtime.jsx)(components_button.A,{onClick:()=>setValue(defaultTemplate),children:"Reset to default"}),(0,jsx_runtime.jsx)(components_button.A,{variant:"primary",disabled:value.length<3,onClick:()=>onConfirm(value),children:"Confirm"})]})})),[setVisible,onConfirm,value,defaultTemplate]),isUsingDefaultTemplate=value===defaultTemplate;return(0,jsx_runtime.jsx)(modal.A,{header:(0,jsx_runtime.jsx)(header.A,{children:"Custom Template"}),visible,footer,onDismiss:()=>setVisible(!1),children:(0,jsx_runtime.jsxs)(space_between.A,{direction:"vertical",size:"l",children:[(0,jsx_runtime.jsx)(components_alert.A,{type:"info",header:isUsingDefaultTemplate?"Default template is used":"Custom template is used",children:isUsingDefaultTemplate?"You can create a custom template to control how your statement is renderer. It is only applicable to the currently editing statement.":"You can edit the custom template or reset it to the default template. It is only applicable to the currently editing statement. "}),(0,jsx_runtime.jsxs)(box.A,{children:[(0,jsx_runtime.jsx)("p",{children:(0,jsx_runtime.jsx)("b",{children:"Renderer Statement:"})}),(0,jsx_runtime.jsx)("p",{children:renderedStatement})]}),(0,jsx_runtime.jsx)(Textarea.A,{value,onChange:({detail})=>setValue(detail.value),label:"Template",validateData:customTypes.FV.shape.customTemplate.safeParse,constraintText:"Tokens like [threat_source], [prerequisites], [threat_action], [threat_impact], [impacted_goal] or [impacted_assets] will be replaced by actual content. "})]})})};CustomTemplate.displayName="CustomTemplate";const threats_CustomTemplate=CustomTemplate;try{CustomTemplate.displayName="CustomTemplate",CustomTemplate.__docgenInfo={description:"",displayName:"CustomTemplate",props:{visible:{defaultValue:null,description:"",name:"visible",required:!0,type:{name:"boolean"}},setVisible:{defaultValue:null,description:"",name:"setVisible",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"(template: string) => void"}},statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},defaultTemplate:{defaultValue:null,description:"",name:"defaultTemplate",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/CustomTemplate/index.tsx#CustomTemplate"]={docgenInfo:CustomTemplate.__docgenInfo,name:"CustomTemplate",path:"src/components/threats/CustomTemplate/index.tsx#CustomTemplate"})}catch(__react_docgen_typescript_loader_error){}var column_layout=__webpack_require__("../../node_modules/@cloudscape-design/components/column-layout/index.js"),token_group=__webpack_require__("../../node_modules/@cloudscape-design/components/token-group/index.js"),BrainstormContext_context=__webpack_require__("./src/contexts/BrainstormContext/context.ts"),autosuggest=__webpack_require__("../../node_modules/@cloudscape-design/components/autosuggest/index.js"),form_field=__webpack_require__("../../node_modules/@cloudscape-design/components/form-field/index.js"),useContentValidation=__webpack_require__("./src/hooks/useContentValidation/index.tsx");const Autosuggest=react.forwardRef((({onChange,value,validateData,errorText:_errorText,...props},ref)=>{const[resetErrorText,setResetErrorText]=(0,react.useState)(),{tempValue,errorText,handleChange}=(0,useContentValidation.A)(value,onChange,validateData),handleKeyDown=(0,react.useCallback)((event=>{8===event.detail.keyCode&&!value&&errorText?setResetErrorText(!0):setResetErrorText(!1),props.onKeyDown?.(event)}),[props.onKeyDown,errorText,value]);return(0,jsx_runtime.jsx)(form_field.A,{...props,errorText:resetErrorText?void 0:errorText,children:(0,jsx_runtime.jsx)(autosuggest.A,{...props,ref,value:errorText?value:tempValue,onChange:event=>handleChange(event),onKeyDown:handleKeyDown})})})),generic_Autosuggest=Autosuggest;try{Autosuggest.displayName="Autosuggest",Autosuggest.__docgenInfo={description:"",displayName:"Autosuggest",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"LegacyRef<any>"}},validateData:{defaultValue:null,description:"",name:"validateData",required:!1,type:{name:"((newValue: string) => ZodSafeParseResult<string>)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/Autosuggest/index.tsx#Autosuggest"]={docgenInfo:Autosuggest.__docgenInfo,name:"Autosuggest",path:"src/components/generic/Autosuggest/index.tsx#Autosuggest"})}catch(__react_docgen_typescript_loader_error){}var input=__webpack_require__("../../node_modules/@cloudscape-design/components/input/index.js"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("../../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const styles={list:(0,emotion_react_browser_esm.AH)({"& button":{padding:`0px ${design_tokens.Gy9} !important`}})},BrainstormList=({items,onSelect,showSearch=!0})=>{const[showMoreItems,setShowMoreItems]=(0,react.useState)(!1),[filterText,setFilterText]=(0,react.useState)(""),filteredItems=(0,react.useMemo)((()=>filterText?items.filter((item=>item.content.toLowerCase().includes(filterText.toLowerCase()))):items),[items,filterText]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(text_content.A,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"vertical",size:"m",children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:"From brainstorm"}),showSearch&&(0,emotion_react_jsx_runtime_browser_esm.Y)(grid.A,{gridDefinition:[{colspan:{default:12,xxs:6}}],children:(0,emotion_react_jsx_runtime_browser_esm.Y)(input.A,{value:filterText,onChange:({detail})=>setFilterText(detail.value),placeholder:"Search brainstorm items"})}),(0,emotion_react_jsx_runtime_browser_esm.Y)("ul",{children:filteredItems.slice(0,showMoreItems?void 0:5).map(((item,index)=>(0,emotion_react_jsx_runtime_browser_esm.Y)("li",{css:styles.list,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"link",onClick:()=>onSelect(item.content),children:item.content})},index)))}),filteredItems.length>5&&(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{iconName:showMoreItems?"treeview-collapse":"treeview-expand",onClick:()=>setShowMoreItems((prev=>!prev)),variant:"link",children:showMoreItems?"Show less items":"Show more items"})]})})};BrainstormList.displayName="BrainstormList";const threats_BrainstormList=BrainstormList;try{BrainstormList.displayName="BrainstormList",BrainstormList.__docgenInfo={description:"",displayName:"BrainstormList",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"{ id: string; content: string; createdAt: string; createdBy?: string | undefined; groupId?: string | undefined; }[]"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(content: string) => void"}},showSearch:{defaultValue:{value:"true"},description:"",name:"showSearch",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/BrainstormList/index.tsx#BrainstormList"]={docgenInfo:BrainstormList.__docgenInfo,name:"BrainstormList",path:"src/components/threats/BrainstormList/index.tsx#BrainstormList"})}catch(__react_docgen_typescript_loader_error){}var container=__webpack_require__("../../node_modules/@cloudscape-design/components/container/index.js");const EditorLayout_styles={container:(0,emotion_react_browser_esm.AH)({marginTop:design_tokens.HV,marginBottom:design_tokens.$_p}),textEditorLayout:(0,emotion_react_browser_esm.AH)({position:"relative"}),input:(0,emotion_react_browser_esm.AH)({display:"inline-block",width:"100%"}),inputClear:(0,emotion_react_browser_esm.AH)({position:"absolute",float:"right",top:"10px",right:"5px"}),inputClearSmall:(0,emotion_react_browser_esm.AH)({position:"absolute",float:"right",top:"1px",right:"5px"})},EditorLayout=({title,description,children,secondaryControl})=>(0,emotion_react_jsx_runtime_browser_esm.Y)(container.A,{header:(0,emotion_react_jsx_runtime_browser_esm.Y)(header.A,{description,children:title}),footer:secondaryControl,children:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.container,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(space_between.A,{direction:"vertical",size:"m",children})})});EditorLayout.displayName="EditorLayout";const threats_EditorLayout=EditorLayout;try{EditorLayout.displayName="EditorLayout",EditorLayout.__docgenInfo={description:"",displayName:"EditorLayout",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"string"}},secondaryControl:{defaultValue:null,description:"",name:"secondaryControl",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorLayout/index.tsx#EditorLayout"]={docgenInfo:EditorLayout.__docgenInfo,name:"EditorLayout",path:"src/components/threats/EditorLayout/index.tsx#EditorLayout"})}catch(__react_docgen_typescript_loader_error){}var toggle=__webpack_require__("../../node_modules/@cloudscape-design/components/toggle/index.js"),renderArrayField=__webpack_require__("./src/utils/renderArrayField/index.ts");const utils_shuffle=array=>{const resultArray=[...array];let randomIndex,currentIndex=array.length;for(;0!=currentIndex;)randomIndex=Math.floor(Math.random()*currentIndex),currentIndex--,[resultArray[currentIndex],resultArray[randomIndex]]=[resultArray[randomIndex],resultArray[currentIndex]];return resultArray},ExampleList_styles={list:(0,emotion_react_browser_esm.AH)({"& button":{padding:`0px ${design_tokens.Gy9} !important`}})},ExampleList=({examples,onSelect,showSearch=!0})=>{const[showMoreExamples,setShowMoreExamples]=(0,react.useState)(!1),[showFullExample,setShowFullExample]=(0,react.useState)(!1),{threatStatementExamples}=(0,ThreatsContext_context.YN)(),[filterText,setFilterText]=(0,react.useState)(""),randomDislayList=(0,react.useMemo)((()=>{let randomExamples=utils_shuffle(examples);return filterText&&(randomExamples=randomExamples.filter((re=>"string"==typeof re?re.toLowerCase().indexOf(filterText)>=0:Array.isArray(re)?re.some((e=>e.toLowerCase().indexOf(filterText)>=0)):re.example.toLowerCase().indexOf(filterText)>=0))),randomExamples}),[examples,filterText]),showFullExampleToggle=(0,react.useMemo)((()=>!!(examples&&examples.length>0)&&("string"!=typeof examples[0]&&!!examples[0].example)),[examples]),renderExample=(0,react.useCallback)((example=>{if("string"==typeof example)return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"link",onClick:()=>onSelect(example),children:example});if(Array.isArray(example)&&example.length>0&&"string"==typeof example[0]){const exampleStr=(0,renderArrayField.A)(example);return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"link",onClick:()=>onSelect(exampleStr),children:exampleStr})}const perFieldExamples=example;if(void 0!==perFieldExamples.fromId&&void 0!==perFieldExamples.example){if(showFullExample){const fullExample=threatStatementExamples[perFieldExamples.fromId].statement;if(fullExample){const index=fullExample.indexOf(perFieldExamples.example);return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:fullExample.slice(0,index)}),(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"link",onClick:()=>onSelect(perFieldExamples.example),children:perFieldExamples.example}),(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:fullExample.slice(index+perFieldExamples.example.length)})]})}}return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"link",onClick:()=>onSelect(perFieldExamples.example),children:perFieldExamples.example})}}),[showFullExample,threatStatementExamples]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(text_content.A,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"vertical",size:"m",children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"horizontal",size:"m",children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:"Examples:"}),showFullExampleToggle&&(0,emotion_react_jsx_runtime_browser_esm.Y)(toggle.A,{checked:showFullExample,onChange:({detail})=>setShowFullExample(detail.checked),children:"Show full examples"})]}),showSearch&&(0,emotion_react_jsx_runtime_browser_esm.Y)(grid.A,{gridDefinition:[{colspan:{default:12,xxs:6}}],children:(0,emotion_react_jsx_runtime_browser_esm.Y)(input.A,{value:filterText,onChange:({detail})=>setFilterText(detail.value),placeholder:"Search examples"})}),(0,emotion_react_jsx_runtime_browser_esm.Y)("ul",{children:randomDislayList.slice(0,showMoreExamples?void 0:5).map(((example,index)=>(0,emotion_react_jsx_runtime_browser_esm.Y)("li",{css:ExampleList_styles.list,children:renderExample(example)},index)))}),randomDislayList.length>5&&(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{iconName:showMoreExamples?"treeview-collapse":"treeview-expand",onClick:()=>setShowMoreExamples((prev=>!prev)),variant:"link",children:showMoreExamples?"Show less examples":"Show more examples"})]})})};ExampleList.displayName="ExampleList";const threats_ExampleList=ExampleList;try{ExampleList.displayName="ExampleList",ExampleList.__docgenInfo={description:"",displayName:"ExampleList",props:{examples:{defaultValue:null,description:"",name:"examples",required:!0,type:{name:"T[]"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(example: string) => void"}},showSearch:{defaultValue:{value:"true"},description:"",name:"showSearch",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/ExampleList/index.tsx#ExampleList"]={docgenInfo:ExampleList.__docgenInfo,name:"ExampleList",path:"src/components/threats/ExampleList/index.tsx#ExampleList"})}catch(__react_docgen_typescript_loader_error){}const EditorImpactedAssets=(0,react.forwardRef)((({statement,setStatement,fieldData},_ref)=>{const{perFieldExamples,previousInputs}=(0,ThreatsContext_context.YN)(),{brainstormData}=(0,BrainstormContext_context.G)(),[value,setValue]=(0,react.useState)(""),handleAddAsset=(0,react.useCallback)((asset=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,impactedAssets:prevStatement.impactedAssets?prevStatement.impactedAssets.includes(asset)?[...prevStatement.impactedAssets]:[...prevStatement.impactedAssets,asset]:[asset]})),setValue("")}),[setStatement]),handleSelect=(0,react.useCallback)((({detail})=>{handleAddAsset(detail.value.trim())}),[handleAddAsset]),handleRemoveAsset=(0,react.useCallback)((({detail:{itemIndex}})=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,impactedAssets:prevStatement.impactedAssets?[...prevStatement.impactedAssets?.slice(0,itemIndex),...prevStatement.impactedAssets?.slice(itemIndex+1)]:[]}))}),[setStatement]),handleKeyDown=(0,react.useCallback)((({detail})=>{13===detail.keyCode&&(handleAddAsset?.(value),setValue(""))}),[handleAddAsset,value]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(generic_Autosuggest,{onChange:({detail})=>setValue(detail.value),onSelect:handleSelect,value,options:Array.from(new Set([...previousInputs.impacted_assets,...(brainstormData.assets||[]).map((asset=>asset.content))])).map((assetValue=>({value:assetValue}))),enteredTextLabel:enteredValue=>`Use: "${enteredValue}"`,ariaLabel:"Autosuggest for impacted assets",placeholder:"Select an existing asset or enter new asset",empty:"No matches found",onKeyDown:handleKeyDown,validateData:customTypes.uQ.safeParse}),(0,emotion_react_jsx_runtime_browser_esm.Y)(token_group.A,{onDismiss:handleRemoveAsset,items:statement.impactedAssets?.map((asset=>({label:asset,dismissLabel:`Remove ${asset}`})))}),(0,emotion_react_jsx_runtime_browser_esm.FD)(column_layout.A,{columns:(perFieldExamples.impacted_assets.length>0?1:0)+((brainstormData.assets?.length||0)>0?1:0),children:[perFieldExamples.impacted_assets.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_ExampleList,{examples:perFieldExamples.impacted_assets,onSelect:handleAddAsset,showSearch:!1}),(brainstormData.assets?.length||0)>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_BrainstormList,{items:brainstormData.assets||[],onSelect:handleAddAsset})]})]})})),threats_EditorImpactedAssets=EditorImpactedAssets;try{EditorImpactedAssets.displayName="EditorImpactedAssets",EditorImpactedAssets.__docgenInfo={description:"",displayName:"EditorImpactedAssets",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorImpactedAssets/index.tsx#EditorImpactedAssets"]={docgenInfo:EditorImpactedAssets.__docgenInfo,name:"EditorImpactedAssets",path:"src/components/threats/EditorImpactedAssets/index.tsx#EditorImpactedAssets"})}catch(__react_docgen_typescript_loader_error){}const EditorImpactedGoal=(0,react.forwardRef)((({statement,setStatement,fieldData},_ref)=>{const[value,setValue]=(0,react.useState)(""),{perFieldExamples}=(0,ThreatsContext_context.YN)(),handleAddImpactedGoal=(0,react.useCallback)((impactedGoal=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,impactedGoal:prevStatement.impactedGoal?prevStatement.impactedGoal.includes(impactedGoal)?[...prevStatement.impactedGoal]:[...prevStatement.impactedGoal,impactedGoal]:[impactedGoal]})),setValue("")}),[setStatement]),handleSelect=(0,react.useCallback)((({detail})=>{handleAddImpactedGoal(detail.value.trim())}),[handleAddImpactedGoal]),handleRemoveImpactedGoal=(0,react.useCallback)((({detail:{itemIndex}})=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,impactedGoal:prevStatement.impactedGoal?[...prevStatement.impactedGoal?.slice(0,itemIndex),...prevStatement.impactedGoal?.slice(itemIndex+1)]:[]}))}),[setStatement]),handleExampleClicked=(0,react.useCallback)((example=>{example.replace("and/or","").replace("and","").replace("or","").split(/[\s,]+/).forEach((token=>handleAddImpactedGoal(token)))}),[handleAddImpactedGoal]),handleKeyDown=(0,react.useCallback)((({detail})=>{13===detail.keyCode&&(handleAddImpactedGoal?.(value),setValue(""))}),[handleAddImpactedGoal,value]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(generic_Autosuggest,{onChange:({detail})=>setValue(detail.value),onSelect:handleSelect,value,options:fieldData.tokens?.map((token=>({value:token}))),enteredTextLabel:enteredValue=>`Use: "${enteredValue}"`,ariaLabel:"Autosuggest for impacted goals",placeholder:"Select an impacted goal or enter new one",empty:"No matches found",onKeyDown:handleKeyDown,validateData:customTypes.de.safeParse}),(0,emotion_react_jsx_runtime_browser_esm.Y)(token_group.A,{onDismiss:handleRemoveImpactedGoal,items:statement.impactedGoal?.map((goal=>({label:goal,dismissLabel:`Remove ${goal}`})))}),perFieldExamples.impacted_goal.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_ExampleList,{examples:perFieldExamples.impacted_goal,onSelect:handleExampleClicked,showSearch:!1})]})})),threats_EditorImpactedGoal=EditorImpactedGoal;try{EditorImpactedGoal.displayName="EditorImpactedGoal",EditorImpactedGoal.__docgenInfo={description:"",displayName:"EditorImpactedGoal",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorImpactedGoal/index.tsx#EditorImpactedGoal"]={docgenInfo:EditorImpactedGoal.__docgenInfo,name:"EditorImpactedGoal",path:"src/components/threats/EditorImpactedGoal/index.tsx#EditorImpactedGoal"})}catch(__react_docgen_typescript_loader_error){}const PreviousInputList_styles={list:(0,emotion_react_browser_esm.AH)({"& button":{padding:`0px ${design_tokens.Gy9} !important`}})},PreviousInputList=({items,onSelect,showSearch=!0})=>{const[showMoreItems,setShowMoreItems]=(0,react.useState)(!1),[filterText,setFilterText]=(0,react.useState)(""),filteredItems=(0,react.useMemo)((()=>filterText?items.filter((item=>"string"==typeof item?item.toLowerCase().includes(filterText.toLowerCase()):item.example.toLowerCase().includes(filterText.toLowerCase()))):items),[items,filterText]),renderItem=(0,react.useCallback)((item=>{if("string"==typeof item)return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"link",onClick:()=>onSelect(item),children:item});const perFieldExample=item;return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"link",onClick:()=>onSelect(perFieldExample.example),children:perFieldExample.example})}),[onSelect]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(text_content.A,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"vertical",size:"m",children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:"From previous input"}),showSearch&&(0,emotion_react_jsx_runtime_browser_esm.Y)(grid.A,{gridDefinition:[{colspan:{default:12,xxs:6}}],children:(0,emotion_react_jsx_runtime_browser_esm.Y)(input.A,{value:filterText,onChange:({detail})=>setFilterText(detail.value),placeholder:"Search previous inputs"})}),(0,emotion_react_jsx_runtime_browser_esm.Y)("ul",{children:filteredItems.slice(0,showMoreItems?void 0:5).map(((item,index)=>(0,emotion_react_jsx_runtime_browser_esm.Y)("li",{css:PreviousInputList_styles.list,children:renderItem(item)},index)))}),filteredItems.length>5&&(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{iconName:showMoreItems?"treeview-collapse":"treeview-expand",onClick:()=>setShowMoreItems((prev=>!prev)),variant:"link",children:showMoreItems?"Show less items":"Show more items"})]})})};PreviousInputList.displayName="PreviousInputList";const threats_PreviousInputList=PreviousInputList;try{PreviousInputList.displayName="PreviousInputList",PreviousInputList.__docgenInfo={description:"",displayName:"PreviousInputList",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"T[]"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(item: string) => void"}},showSearch:{defaultValue:{value:"true"},description:"",name:"showSearch",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/PreviousInputList/index.tsx#PreviousInputList"]={docgenInfo:PreviousInputList.__docgenInfo,name:"PreviousInputList",path:"src/components/threats/PreviousInputList/index.tsx#PreviousInputList"})}catch(__react_docgen_typescript_loader_error){}const EditorPrerequisites=(0,react.forwardRef)((({statement,setStatement,fieldData},ref)=>{const inputRef=(0,react.useRef)(),{perFieldExamples,previousInputs}=(0,ThreatsContext_context.YN)(),{brainstormData}=(0,BrainstormContext_context.G)();(0,react.useImperativeHandle)(ref,(()=>({focus(){inputRef.current?.focus()}})),[]);const handleChange=(0,react.useCallback)((prerequisites=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,prerequisites}))}),[setStatement]),handleSelect=(0,react.useCallback)((prerequisites=>{handleChange(prerequisites),inputRef.current?.focus()}),[handleChange]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{css:EditorLayout_styles.textEditorLayout,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.input,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Textarea.A,{ref:inputRef,onChange:({detail})=>handleChange(detail.value),value:statement.prerequisites||"",placeholder:"Enter prerequisites",spellcheck:!0,singleLine:!0,validateData:customTypes.FV.shape.prerequisites.safeParse,rows:2,stretch:!0})}),statement.prerequisites&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.inputClear,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"icon",iconName:"close",onClick:()=>handleChange("")})})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(column_layout.A,{columns:(perFieldExamples.prerequisites.length>0?1:0)+(previousInputs.prerequisites.length>0?1:0)+((brainstormData.threatPrerequisites?.length||0)>0?1:0),children:[perFieldExamples.prerequisites.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_ExampleList,{examples:perFieldExamples.prerequisites,onSelect:handleSelect}),previousInputs.prerequisites.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_PreviousInputList,{items:previousInputs.prerequisites,onSelect:content=>handleSelect(content)}),(brainstormData.threatPrerequisites?.length||0)>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_BrainstormList,{items:brainstormData.threatPrerequisites||[],onSelect:handleSelect})]})]})})),threats_EditorPrerequisites=EditorPrerequisites;try{EditorPrerequisites.displayName="EditorPrerequisites",EditorPrerequisites.__docgenInfo={description:"",displayName:"EditorPrerequisites",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorPrerequisites/index.tsx#EditorPrerequisites"]={docgenInfo:EditorPrerequisites.__docgenInfo,name:"EditorPrerequisites",path:"src/components/threats/EditorPrerequisites/index.tsx#EditorPrerequisites"})}catch(__react_docgen_typescript_loader_error){}const EditorThreatAction=(0,react.forwardRef)((({statement,setStatement,fieldData},ref)=>{const inputRef=(0,react.useRef)(),{perFieldExamples,previousInputs}=(0,ThreatsContext_context.YN)(),{brainstormData}=(0,BrainstormContext_context.G)();(0,react.useImperativeHandle)(ref,(()=>({focus(){inputRef.current?.focus()}})),[]);const handleChange=(0,react.useCallback)((threatAction=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,threatAction}))}),[setStatement]),handleSelect=(0,react.useCallback)((threatAction=>{handleChange(threatAction),inputRef.current?.focus()}),[handleChange]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{css:EditorLayout_styles.textEditorLayout,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.input,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Textarea.A,{ref:inputRef,spellcheck:!0,onChange:({detail})=>handleChange(detail.value),value:statement.threatAction||"",placeholder:"Enter threat action",validateData:customTypes.FV.shape.threatAction.safeParse,rows:2,singleLine:!0,stretch:!0})}),statement.threatAction&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.inputClear,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"icon",iconName:"close",onClick:()=>handleChange("")})})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(column_layout.A,{columns:(perFieldExamples.threat_action.length>0?1:0)+(previousInputs.threat_action.length>0?1:0)+((brainstormData.threatActions?.length||0)>0?1:0),children:[perFieldExamples.threat_action.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_ExampleList,{examples:perFieldExamples.threat_action,onSelect:handleSelect}),previousInputs.threat_action.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_PreviousInputList,{items:previousInputs.threat_action,onSelect:content=>handleSelect(content)}),(brainstormData.threatActions?.length||0)>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_BrainstormList,{items:brainstormData.threatActions||[],onSelect:handleSelect})]})]})})),threats_EditorThreatAction=EditorThreatAction;try{EditorThreatAction.displayName="EditorThreatAction",EditorThreatAction.__docgenInfo={description:"",displayName:"EditorThreatAction",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorThreatAction/index.tsx#EditorThreatAction"]={docgenInfo:EditorThreatAction.__docgenInfo,name:"EditorThreatAction",path:"src/components/threats/EditorThreatAction/index.tsx#EditorThreatAction"})}catch(__react_docgen_typescript_loader_error){}const EditorThreatImpact=(0,react.forwardRef)((({statement,setStatement,fieldData},ref)=>{const inputRef=(0,react.useRef)(),{perFieldExamples,previousInputs}=(0,ThreatsContext_context.YN)(),{brainstormData}=(0,BrainstormContext_context.G)();(0,react.useImperativeHandle)(ref,(()=>({focus(){inputRef.current?.focus()}})),[]);const handleChange=(0,react.useCallback)((threatImpact=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,threatImpact}))}),[setStatement]),handleSelect=(0,react.useCallback)((threatImpact=>{handleChange(threatImpact),inputRef.current?.focus()}),[handleChange]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{css:EditorLayout_styles.textEditorLayout,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.input,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Textarea.A,{ref:inputRef,spellcheck:!0,onChange:({detail})=>handleChange(detail.value),value:statement.threatImpact||"",placeholder:"Enter threat impact",validateData:customTypes.FV.shape.threatImpact.safeParse,rows:2,singleLine:!0,stretch:!0})}),statement.threatImpact&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.inputClear,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"icon",iconName:"close",onClick:()=>handleChange("")})})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(column_layout.A,{columns:(perFieldExamples.threat_impact.length>0?1:0)+(previousInputs.threat_impact.length>0?1:0)+((brainstormData.threatImpacts?.length||0)>0?1:0),children:[perFieldExamples.threat_impact.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_ExampleList,{examples:perFieldExamples.threat_impact,onSelect:handleSelect}),previousInputs.threat_impact.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_PreviousInputList,{items:previousInputs.threat_impact,onSelect:content=>handleSelect(content)}),(brainstormData.threatImpacts?.length||0)>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_BrainstormList,{items:brainstormData.threatImpacts||[],onSelect:handleSelect})]})]})})),threats_EditorThreatImpact=EditorThreatImpact;try{EditorThreatImpact.displayName="EditorThreatImpact",EditorThreatImpact.__docgenInfo={description:"",displayName:"EditorThreatImpact",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorThreatImpact/index.tsx#EditorThreatImpact"]={docgenInfo:EditorThreatImpact.__docgenInfo,name:"EditorThreatImpact",path:"src/components/threats/EditorThreatImpact/index.tsx#EditorThreatImpact"})}catch(__react_docgen_typescript_loader_error){}var Input=__webpack_require__("./src/components/generic/Input/index.tsx");const EditorThreatSource=(0,react.forwardRef)((({statement,setStatement,fieldData},ref)=>{const{perFieldExamples,previousInputs}=(0,ThreatsContext_context.YN)(),{brainstormData}=(0,BrainstormContext_context.G)(),valueRef=(0,react.useRef)(statement.threatSource);(0,react.useEffect)((()=>{valueRef.current=statement.threatSource?.trim()}),[statement.threatSource]);const handleChange=(0,react.useCallback)((threatSource=>{setStatement((prevStatement=>prevStatement&&{...prevStatement,threatSource}))}),[setStatement]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(threats_EditorLayout,{title:fieldData.displayTitle,description:fieldData.description,children:[(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{css:EditorLayout_styles.textEditorLayout,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.input,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Input.A,{ref,spellcheck:!0,onChange:({detail})=>handleChange(detail.value),value:statement.threatSource||"",placeholder:"Enter threat source",validateData:customTypes.FV.shape.threatSource.safeParse,stretch:!0})}),statement.threatSource&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:EditorLayout_styles.inputClearSmall,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"icon",iconName:"close",onClick:()=>handleChange("")})})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(column_layout.A,{columns:(perFieldExamples.threat_source.length>0?1:0)+(previousInputs.threat_source.length>0?1:0)+((brainstormData.threatSources?.length||0)>0?1:0),children:[perFieldExamples.threat_source.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_ExampleList,{examples:perFieldExamples.threat_source,onSelect:handleChange,showSearch:!1}),previousInputs.threat_source.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_PreviousInputList,{items:previousInputs.threat_source,onSelect:handleChange}),(brainstormData.threatSources?.length||0)>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_BrainstormList,{items:brainstormData.threatSources||[],onSelect:handleChange})]})]})})),threats_EditorThreatSource=EditorThreatSource;try{EditorThreatSource.displayName="EditorThreatSource",EditorThreatSource.__docgenInfo={description:"",displayName:"EditorThreatSource",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},setStatement:{defaultValue:null,description:"",name:"setStatement",required:!0,type:{name:"Dispatch<SetStateAction<{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; } | null>>"}},fieldData:{defaultValue:null,description:"",name:"fieldData",required:!0,type:{name:"ThreatFieldData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/EditorThreatSource/index.tsx#EditorThreatSource"]={docgenInfo:EditorThreatSource.__docgenInfo,name:"EditorThreatSource",path:"src/components/threats/EditorThreatSource/index.tsx#EditorThreatSource"})}catch(__react_docgen_typescript_loader_error){}var button_dropdown=__webpack_require__("../../node_modules/@cloudscape-design/components/button-dropdown/index.js");const ExpandableToken=({expanded,onClick,tooltip})=>(0,jsx_runtime.jsx)(Tooltip.A,{tooltip,children:(0,jsx_runtime.jsx)(components_button.A,{iconName:expanded?"treeview-collapse":"treeview-expand",variant:"icon",onClick})});ExpandableToken.displayName="ExpandableToken";const components_ExpandableToken=ExpandableToken;try{ExpandableToken.displayName="ExpandableToken",ExpandableToken.__docgenInfo={description:"",displayName:"ExpandableToken",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void)"}},expanded:{defaultValue:null,description:"",name:"expanded",required:!0,type:{name:"boolean"}},tooltip:{defaultValue:null,description:"",name:"tooltip",required:!0,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FieldSelector/components/ExpandableToken/index.tsx#ExpandableToken"]={docgenInfo:ExpandableToken.__docgenInfo,name:"ExpandableToken",path:"src/components/threats/FieldSelector/components/ExpandableToken/index.tsx#ExpandableToken"})}catch(__react_docgen_typescript_loader_error){}const Token=({children,onClick,highlighted,filled,tooltip})=>{const bgColor=highlighted?design_tokens.dWw:filled?design_tokens.cw3:design_tokens.ORV;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Tooltip.A,{tooltip,children:(0,emotion_react_jsx_runtime_browser_esm.Y)("button",{css:emotion_react_browser_esm.AH`
        text-align: left;
        text-decoration: none;
        border-spacing: 0;
        border-collapse: separate;
        border: 1px solid;
        border-radius: ${design_tokens.Qvm};
        height: fit-content !important;
        padding: ${design_tokens.M1y};
        color: ${design_tokens.SM4};
        background-color: ${bgColor};
      `,onClick,children:(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children})})})};Token.displayName="Token";const components_Token=Token;try{Token.displayName="Token",Token.__docgenInfo={description:"",displayName:"Token",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}},highlighted:{defaultValue:null,description:"",name:"highlighted",required:!1,type:{name:"boolean"}},filled:{defaultValue:null,description:"",name:"filled",required:!1,type:{name:"boolean"}},tooltip:{defaultValue:null,description:"",name:"tooltip",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FieldSelector/components/Token/index.tsx#Token"]={docgenInfo:Token.__docgenInfo,name:"Token",path:"src/components/threats/FieldSelector/components/Token/index.tsx#Token"})}catch(__react_docgen_typescript_loader_error){}var parseThreatStatement=__webpack_require__("./src/utils/parseThreatStatement/index.ts"),expandable_section=__webpack_require__("../../node_modules/@cloudscape-design/components/expandable-section/index.js"),getMobileMediaQuery=__webpack_require__("./src/utils/getMobileMediaQuery/index.tsx");const Suggestions_styles={suggestionGroups:(0,emotion_react_browser_esm.AH)({display:"table"}),suggestionGroup:(0,emotion_react_browser_esm.AH)({display:"table-row"}),suggestionButtonWrapper:(0,emotion_react_browser_esm.AH)({display:"table-cell","& > button > span":{whiteSpace:"nowrap"},[(0,getMobileMediaQuery.A)()]:{display:"block"}}),suggestion:(0,emotion_react_browser_esm.AH)({display:"table-cell",alignSelf:"center",[(0,getMobileMediaQuery.A)()]:{display:"block"}})},Suggestions=({suggestions,setEditor})=>{const[showMoresuggestions,setShowMoresuggestions]=(0,react.useState)(suggestions&&suggestions?.length>2),suggestionGroups=(0,react.useMemo)((()=>suggestions?.reduce(((group,suggestion)=>{if(0===suggestion.indexOf("[")){const endIndex=suggestion.indexOf("]"),token=suggestion.slice(1,endIndex),content=suggestion.slice(endIndex+1).trim();return{...group,[token]:group[token]?[...group[token],content]:[content]}}return{...group,GENERAL:group.GENERAL?[...group.GENERAL,suggestion]:[suggestion]}}),{})),[suggestions]),renderSuggestionGroup=(0,react.useCallback)(((groups,token)=>{const group=groups[token];return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{css:Suggestions_styles.suggestionGroup,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:Suggestions_styles.suggestionButtonWrapper,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"link",onClick:()=>setEditor(token),children:"GENERAL"!==token&&group&&threatFieldData.A[token]?.displayTitle})}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:Suggestions_styles.suggestion,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(space_between.A,{direction:"vertical",size:"xxxs",children:group.map(((r,index)=>(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:["- ",r]},index)))})})]},token)}),[setEditor]);return suggestions&&suggestions.length>0&&suggestionGroups?(0,emotion_react_jsx_runtime_browser_esm.Y)(expandable_section.A,{headerText:`Suggestions (${suggestions.length})`,defaultExpanded:!0,children:(0,emotion_react_jsx_runtime_browser_esm.FD)(text_content.A,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:Suggestions_styles.suggestionGroups,children:Object.keys(suggestionGroups).slice(0,showMoresuggestions?Object.keys(suggestionGroups).length:2).map((token=>renderSuggestionGroup(suggestionGroups,token)))}),Object.keys(suggestionGroups).length>2&&(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{iconName:showMoresuggestions?"treeview-collapse":"treeview-expand",onClick:()=>setShowMoresuggestions((prev=>!prev)),variant:"link",children:showMoresuggestions?"Show less suggestions":"Show more suggestions"})]})}):null},threats_Suggestions=Suggestions;try{Suggestions.displayName="Suggestions",Suggestions.__docgenInfo={description:"",displayName:"Suggestions",props:{suggestions:{defaultValue:null,description:"",name:"suggestions",required:!1,type:{name:"string[]"}},setEditor:{defaultValue:null,description:"",name:"setEditor",required:!0,type:{name:"(type: ThreatFieldTypes) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/Suggestions/index.tsx#Suggestions"]={docgenInfo:Suggestions.__docgenInfo,name:"Suggestions",path:"src/components/threats/Suggestions/index.tsx#Suggestions"})}catch(__react_docgen_typescript_loader_error){}const defaultThreatStatementFormat=threatStatementFormat.A[63],FieldSelector_styles={selector:(0,emotion_react_browser_esm.AH)({lineHeight:"2.5"})},FieldSelector=({composerMode,onStartOver,setEditor,currentEditor,statement,suggestions,onGiveExampleClick,setCustomTemplateEditorVisible})=>{const[expandedImpactedGoal,setExpandedImpactedGoal]=(0,react.useState)(!1);(0,react.useEffect)((()=>{"impacted_goal"===currentEditor&&setExpandedImpactedGoal(!0)}),[currentEditor]),(0,react.useEffect)((()=>{setExpandedImpactedGoal(!1)}),[statement]);const{showInfoModal}=(0,GlobalSetupContext_context.$)(),selector=(0,react.useMemo)((()=>{let renderShortenImpactedGoal=!1,template=statement.customTemplate||defaultThreatStatementFormat.template;return(0,parseThreatStatement.A)({statement,template,outputProcessor:(token,content,before,filled)=>{const output=[];return"impacted_goal"!==token||expandedImpactedGoal||filled||statement.customTemplate?(renderShortenImpactedGoal?output.push("negatively impacting "):output.push(before),output.push((0,emotion_react_jsx_runtime_browser_esm.Y)(components_Token,{highlighted:currentEditor===token,filled:!!filled,tooltip:threatFieldData.A[token]?.tooltip,onClick:()=>setEditor(token),children:content},token)),"impacted_goal"===token&&!filled&&output.push((0,emotion_react_jsx_runtime_browser_esm.Y)(components_ExpandableToken,{expanded:!0,tooltip:`Collapse ${threatFieldData.A[token]?.tooltip}`,onClick:()=>{setExpandedImpactedGoal(!1);const nextEditor=getRecommandedEditor(statement);nextEditor&&setEditor(nextEditor)}},"field_selector_impacted_goal_collpase"))):(output.push(","),output.push((0,emotion_react_jsx_runtime_browser_esm.Y)(components_ExpandableToken,{tooltip:`Expand ${threatFieldData.A[token]?.tooltip}`,expanded:!1,onClick:()=>{setExpandedImpactedGoal(!0),setEditor("impacted_goal")}},"field_selector_impacted_goal_expand")),renderShortenImpactedGoal=!0),output}})}),[statement,setEditor,currentEditor,suggestions,expandedImpactedGoal,setExpandedImpactedGoal]),handleMoreActions=(0,react.useCallback)((({detail})=>{if("customTemplate"===detail.id)setCustomTemplateEditorVisible(!0);else console.log("Unknown action",detail.id)}),[setCustomTemplateEditorVisible]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(container.A,{header:(0,emotion_react_jsx_runtime_browser_esm.Y)(header.A,{info:"Full"===composerMode?void 0:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"icon",iconName:"status-info",onClick:showInfoModal}),actions:(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"horizontal",size:"s",children:["EditorOnly"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{onClick:onStartOver,children:"Start over"}),onGiveExampleClick&&(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{onClick:onGiveExampleClick,children:"Give me a random example"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(button_dropdown.A,{items:[{id:"customTemplate",text:"Custom Template"}],ariaLabel:"More actions",variant:"icon",onItemClick:handleMoreActions})]}),description:"Start by clicking ANY field you like and work from there...",children:"Let's write a threat statement!"}),children:(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"vertical",size:"s",children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(text_content.A,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:FieldSelector_styles.selector,children:selector})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_Suggestions,{suggestions,setEditor})]})})};FieldSelector.displayName="FieldSelector";const threats_FieldSelector=FieldSelector;try{FieldSelector.displayName="FieldSelector",FieldSelector.__docgenInfo={description:"",displayName:"FieldSelector",props:{composerMode:{defaultValue:null,description:"",name:"composerMode",required:!0,type:{name:"enum",value:[{value:'"ThreatsOnly"'},{value:'"EditorOnly"'},{value:'"Full"'}]}},currentEditor:{defaultValue:null,description:"",name:"currentEditor",required:!1,type:{name:"enum",value:[{value:'"prerequisites"'},{value:'"threat_source"'},{value:'"threat_action"'},{value:'"threat_impact"'},{value:'"impacted_goal"'},{value:'"impacted_assets"'}]}},setEditor:{defaultValue:null,description:"",name:"setEditor",required:!0,type:{name:"(type: ThreatFieldTypes) => void"}},statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},suggestions:{defaultValue:null,description:"",name:"suggestions",required:!1,type:{name:"string[]"}},onGiveExampleClick:{defaultValue:null,description:"",name:"onGiveExampleClick",required:!1,type:{name:"(() => void)"}},setCustomTemplateEditorVisible:{defaultValue:null,description:"",name:"setCustomTemplateEditorVisible",required:!0,type:{name:"(visible: boolean) => void"}},onStartOver:{defaultValue:null,description:"",name:"onStartOver",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FieldSelector/index.tsx#FieldSelector"]={docgenInfo:FieldSelector.__docgenInfo,name:"FieldSelector",path:"src/components/threats/FieldSelector/index.tsx#FieldSelector"})}catch(__react_docgen_typescript_loader_error){}var CopyToClipboard=__webpack_require__("./src/components/generic/CopyToClipboard/index.tsx");const FinalStatement=({statement,displayStatement})=>(0,emotion_react_jsx_runtime_browser_esm.Y)(text_content.A,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("p",{css:emotion_react_browser_esm.AH`
        font-size: 20px !important;
        line-height: 1.5 !important;
      `,children:(statement.statement||displayStatement&&displayStatement.length>0)&&(0,emotion_react_jsx_runtime_browser_esm.Y)(CopyToClipboard.A,{content:statement.statement,children:displayStatement||statement.statement})})});FinalStatement.displayName="FinalStatement";const threats_FinalStatement=FinalStatement;try{FinalStatement.displayName="FinalStatement",FinalStatement.__docgenInfo={description:"",displayName:"FinalStatement",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},displayStatement:{defaultValue:null,description:"",name:"displayStatement",required:!1,type:{name:"ReactNode[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FinalStatement/index.tsx#FinalStatement"]={docgenInfo:FinalStatement.__docgenInfo,name:"FinalStatement",path:"src/components/threats/FinalStatement/index.tsx#FinalStatement"})}catch(__react_docgen_typescript_loader_error){}var property_filter=__webpack_require__("../../node_modules/@cloudscape-design/components/property-filter/index.js"),stride=__webpack_require__("./src/data/stride.ts");const intersection=(arr1,arr2)=>{const res=[];for(let i=0;i<arr1.length;i++)arr2.includes(arr1[i])&&res.push(arr1[i]);return res},utils_intersectArrays=(...arrs)=>{let res=arrs[0].slice();for(let i=1;i<arrs.length;i++)res=intersection(res,arrs[i]);return res},FullExamples=(0,react.forwardRef)((({onClick},ref)=>{const{threatStatementExamples}=(0,ThreatsContext_context.YN)(),[expanded,setExpanded]=(0,react.useState)(!1),[query,setQuery]=(0,react.useState)({tokens:[],operation:"and"});(0,react.useImperativeHandle)(ref,(()=>({collapse(){setExpanded(!1)}})),[]);const handleClick=(0,react.useCallback)((example=>{setExpanded(!1),onClick?.(example)}),[onClick]),filteredThreatStatementList=(0,react.useMemo)((()=>{let resultExamples=[...threatStatementExamples];if(query.tokens.length>0){const queryResult=query.tokens.map((t=>((statements,token)=>{const targetValue=token.value?.slice(0,1).toUpperCase(),result=[];return statements.forEach(((st,index)=>{if("STRIDE"===token.propertyKey){const value=st.metadata?.find((m=>"STRIDE"===m.key))?.value;value||"!="!==token.operator||result.push(index),value&&"="===token.operator&&value.includes(targetValue)&&result.push(index),"="===token.operator||value&&value.includes(targetValue)||result.push(index)}else(token.propertyKey||":"!==token.operator||st.statement&&st.statement.toLocaleLowerCase().indexOf(token.value)>=0)&&result.push(index)})),result})(threatStatementExamples,t)));let mergeResult=[];mergeResult=1===queryResult.length?queryResult[0]:"or"===query.operation?queryResult.reduce(((arr,cur)=>{const result=[...arr];return cur.forEach((n=>{result.includes(n)||result.push(n)})),result}),[]):utils_intersectArrays(...queryResult),resultExamples=resultExamples.filter(((_r,index)=>mergeResult.includes(index)))}return utils_shuffle(resultExamples)}),[threatStatementExamples,query]),filteringOptions=(0,react.useMemo)((()=>{const options=[];return options.push(...stride.A.map((v=>({propertyKey:"STRIDE",value:v.label})))),options}),[]),filteringProperties=(0,react.useMemo)((()=>[{key:"STRIDE",operators:["=","!="],propertyLabel:"STRIDE",groupValuesLabel:"STRIDE values"}]),[]);return(0,jsx_runtime.jsx)(expandable_section.A,{headerText:"Full examples",expanded,onChange:({detail})=>setExpanded(detail.expanded),children:(0,jsx_runtime.jsx)(box.A,{padding:"m",children:(0,jsx_runtime.jsxs)(space_between.A,{direction:"vertical",size:"m",children:[(0,jsx_runtime.jsx)(property_filter.A,{onChange:({detail})=>setQuery(detail),query,i18nStrings:{filteringAriaLabel:"your choice",dismissAriaLabel:"Dismiss",filteringPlaceholder:"Filter examples by metadata or content",groupValuesText:"Values",groupPropertiesText:"Properties",operatorsText:"Operators",operationAndText:"and",operationOrText:"or",operatorLessText:"Less than",operatorLessOrEqualText:"Less than or equal",operatorGreaterText:"Greater than",operatorGreaterOrEqualText:"Greater than or equal",operatorContainsText:"Contains",operatorDoesNotContainText:"Does not contain",operatorEqualsText:"Equals",operatorDoesNotEqualText:"Does not equal",editTokenHeader:"Edit filter",propertyText:"Property",operatorText:"Operator",valueText:"Value",cancelActionText:"Cancel",applyActionText:"Apply",allPropertiesLabel:"All properties",tokenLimitShowMore:"Show more",tokenLimitShowFewer:"Show fewer",clearFiltersText:"Clear filters",removeTokenButtonAriaLabel:token=>`Remove token ${token.propertyKey} ${token.operator} ${token.value}`,enteredTextLabel:text=>`Use: "${text}"`},countText:`${filteredThreatStatementList.length} matches`,expandToViewport:!0,filteringOptions,filteringProperties}),(0,jsx_runtime.jsx)(text_content.A,{children:(0,jsx_runtime.jsx)("ul",{children:filteredThreatStatementList.map(((example,index)=>(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)(components_button.A,{onClick:()=>handleClick(example),variant:"link",children:example.statement})},index)))})})]})})})})),threats_FullExamples=FullExamples;try{FullExamples.displayName="FullExamples",FullExamples.__docgenInfo={description:"",displayName:"FullExamples",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(example: { id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }) => void"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"LegacyRef<any>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/FullExamples/index.tsx#FullExamples"]={docgenInfo:FullExamples.__docgenInfo,name:"FullExamples",path:"src/components/threats/FullExamples/index.tsx#FullExamples"})}catch(__react_docgen_typescript_loader_error){}const Header=({statement,saveButtonText,onComplete,onCancel,onStartOver})=>{const actions=(0,react.useMemo)((()=>(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"horizontal",size:"xs",children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{onClick:onCancel,children:"Threat list"}),onStartOver&&(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{onClick:onStartOver,children:"Start over"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(components_button.A,{variant:"primary",onClick:onComplete,disabled:!statement.statement,children:saveButtonText})]})),[onComplete,onCancel,onStartOver]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(header.A,{variant:"h1",actions,children:statement.numericId&&-1!==statement.numericId?`Threat ${statement.numericId}`:void 0})};Header.displayName="Header";const threats_Header=Header;try{Header.displayName="Header",Header.__docgenInfo={description:"",displayName:"Header",props:{composerMode:{defaultValue:null,description:"",name:"composerMode",required:!0,type:{name:"enum",value:[{value:'"ThreatsOnly"'},{value:'"EditorOnly"'},{value:'"Full"'}]}},saveButtonText:{defaultValue:null,description:"",name:"saveButtonText",required:!0,type:{name:"string"}},statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"(() => void)"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"(() => void)"}},onStartOver:{defaultValue:null,description:"",name:"onStartOver",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/Header/index.tsx#Header"]={docgenInfo:Header.__docgenInfo,name:"Header",path:"src/components/threats/Header/index.tsx#Header"})}catch(__react_docgen_typescript_loader_error){}var MetadataEditor=__webpack_require__("./src/components/threats/MetadataEditor/index.tsx"),status_indicator=__webpack_require__("../../node_modules/@cloudscape-design/components/status-indicator/index.js");const Status_styles=(0,emotion_react_browser_esm.AH)({background:"transparent",border:"none !important",cursor:"pointer"}),Status=({completed,label,onClick})=>(0,emotion_react_jsx_runtime_browser_esm.Y)("button",{css:Status_styles,onClick,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(status_indicator.A,{type:completed?"success":"stopped",children:label})});Status.displayName="Status";const components_Status=Status;try{Status.displayName="Status",Status.__docgenInfo={description:"",displayName:"Status",props:{completed:{defaultValue:null,description:"",name:"completed",required:!1,type:{name:"boolean"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/Metrics/components/Status/index.tsx#Status"]={docgenInfo:Status.__docgenInfo,name:"Status",path:"src/components/threats/Metrics/components/Status/index.tsx#Status"})}catch(__react_docgen_typescript_loader_error){}const Metrics=({statement,onClick})=>(0,jsx_runtime.jsx)(container.A,{children:(0,jsx_runtime.jsxs)(space_between.A,{direction:"vertical",size:"s",children:[(0,jsx_runtime.jsx)(text_content.A,{children:(0,jsx_runtime.jsx)("h5",{children:"Inputs for mitigation"})}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.A.threat_source.displayTitle,onClick:()=>onClick("threat_source"),completed:!!statement.threatSource}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.A.prerequisites.displayTitle,onClick:()=>onClick("prerequisites"),completed:!!statement.prerequisites}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.A.threat_action.displayTitle,onClick:()=>onClick("threat_action"),completed:!!statement.threatAction}),(0,jsx_runtime.jsxs)(text_content.A,{children:[(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsx)("h5",{children:"Inputs for prioritization"})]}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.A.threat_impact.displayTitle,onClick:()=>onClick("threat_impact"),completed:!!statement.threatImpact}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.A.impacted_goal.displayTitle,onClick:()=>onClick("impacted_goal"),completed:!!statement.impactedGoal&&statement.impactedGoal.length>0}),(0,jsx_runtime.jsx)(components_Status,{label:threatFieldData.A.impacted_assets.displayTitle,onClick:()=>onClick("impacted_assets"),completed:!!statement.impactedAssets&&statement.impactedAssets.length>0})]})});Metrics.displayName="Metrics";const threats_Metrics=Metrics;try{Metrics.displayName="Metrics",Metrics.__docgenInfo={description:"",displayName:"Metrics",props:{statement:{defaultValue:null,description:"",name:"statement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(token: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/Metrics/index.tsx#Metrics"]={docgenInfo:Metrics.__docgenInfo,name:"Metrics",path:"src/components/threats/Metrics/index.tsx#Metrics"})}catch(__react_docgen_typescript_loader_error){}var contexts=__webpack_require__("./src/contexts/index.ts"),Table=__webpack_require__("./src/components/generic/Table/index.tsx");const MitigationCandidates=({threatPackId,threatPackThreatId,linkedMitigationIds,mitigationList,onAddMitigationsFromMitigationCandidates})=>{const[selectedItems,setSelectedItems]=(0,react.useState)([]),{getMitigationCandidates}=(0,contexts.VW)(),[mitigations,setMitigations]=(0,react.useState)([]),linkedMitigationsFromThreakpack=(0,react.useMemo)((()=>mitigationList.map((x=>{if(linkedMitigationIds.includes(x.id)){const metadata=(0,getMetadata.A)(x.metadata);if(metadata[configs.jU]==threatPackId)return metadata[configs.FY]}})).filter((x=>!!x))),[mitigationList,linkedMitigationIds,threatPackId]);(0,react.useEffect)((()=>{(async()=>{if(threatPackId&&threatPackThreatId){const mitigationCandidates=await getMitigationCandidates(threatPackId,threatPackThreatId);setMitigations(mitigationCandidates)}else setMitigations([])})().catch((err=>console.log("Error",err)))}),[threatPackId,threatPackThreatId,getMitigationCandidates]);const items=(0,react.useMemo)((()=>mitigations.map((x=>{const metadata=(0,getMetadata.A)(x.metadata);return{...x,comments:metadata.Comments||""}}))),[mitigations]),colDef=(0,react.useMemo)((()=>[{id:"content",header:"Mitigation",cell:data=>data.content,minWidth:400,sortingField:"content"},{id:"comments",header:"Comments",cell:data=>data.comments,sortingField:"comments"}]),[]);return 0===items.length?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):(0,jsx_runtime.jsx)(Table.Ay,{columnDefinitions:colDef,actions:(0,jsx_runtime.jsx)(space_between.A,{direction:"horizontal",size:"s",children:(0,jsx_runtime.jsx)(components_button.A,{variant:"primary",disabled:0===selectedItems.length,onClick:()=>onAddMitigationsFromMitigationCandidates(selectedItems,threatPackId),children:"Add as mitigations"})}),header:"Mitigation Candidates",headerVariant:"h3",variant:"embedded",items:items||[],selectedItems,onSelectionChange:({detail})=>setSelectedItems([...detail.selectedItems.map((x=>{const{comments,...data}=x;return data}))]),isItemDisabled:item=>linkedMitigationsFromThreakpack.includes(item.id)})};MitigationCandidates.displayName="MitigationCandidates";const threats_MitigationCandidates=MitigationCandidates;try{MitigationCandidates.displayName="MitigationCandidates",MitigationCandidates.__docgenInfo={description:"",displayName:"MitigationCandidates",props:{threatPackId:{defaultValue:null,description:"",name:"threatPackId",required:!0,type:{name:"string"}},threatPackThreatId:{defaultValue:null,description:"",name:"threatPackThreatId",required:!0,type:{name:"string"}},linkedMitigationIds:{defaultValue:null,description:"",name:"linkedMitigationIds",required:!0,type:{name:"string[]"}},mitigationList:{defaultValue:null,description:"",name:"mitigationList",required:!0,type:{name:'{ id: string; numericId: number; content: string; displayOrder?: number | undefined; tags?: string[] | undefined; metadata?: ({ key: "Comments"; value: string; } | { key: string; value: string | string[]; } | { ...; } | { ...; } | { ...; })[] | undefined; status?: string | undefined; }[]'}},onAddMitigationsFromMitigationCandidates:{defaultValue:null,description:"",name:"onAddMitigationsFromMitigationCandidates",required:!0,type:{name:'(mitigationCandidates: { id: string; numericId: number; content: string; displayOrder?: number | undefined; tags?: string[] | undefined; metadata?: ({ key: "Comments"; value: string; } | { key: string; value: string | string[]; } | { ...; } | { ...; } | { ...; })[] | undefined; status?: string | undefined; }[], thre...'}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/MitigationCandidates/index.tsx#MitigationCandidates"]={docgenInfo:MitigationCandidates.__docgenInfo,name:"MitigationCandidates",path:"src/components/threats/MitigationCandidates/index.tsx#MitigationCandidates"})}catch(__react_docgen_typescript_loader_error){}const ThreatStatementEditor_styles={finalStatementSection:(0,emotion_react_browser_esm.AH)({"&:hover":{backgroundColor:design_tokens.Mzr}}),metadataContainer:(0,emotion_react_browser_esm.AH)({"h3>span>span":{fontSize:"20px"}})},ThreatStatementEditor_defaultThreatStatementFormat=threatStatementFormat.A[63],editorMapping={threat_source:threats_EditorThreatSource,prerequisites:threats_EditorPrerequisites,threat_action:threats_EditorThreatAction,threat_impact:threats_EditorThreatImpact,impacted_goal:threats_EditorImpactedGoal,impacted_assets:threats_EditorImpactedAssets},ContentLayout=({children,editingStatement,composerMode,onCancel,onStartOver,onComplete,saveButtonText})=>"Full"!==composerMode?(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children}):(0,emotion_react_jsx_runtime_browser_esm.Y)(content_layout.A,{disableOverlap:!0,headerVariant:"high-contrast",header:(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_Header,{composerMode,statement:editingStatement,saveButtonText,onCancel,onStartOver,onComplete}),children});ContentLayout.displayName="ContentLayout";const ThreatStatementEditorInner=({editingStatement,onThreatListView,...props})=>{const{setEditingStatement,saveStatement,addStatement}=(0,ThreatsContext_context.YN)(),inputRef=(0,react.useRef)(),fullExamplesRef=(0,react.useRef)(),{currentWorkspace,workspaceList}=(0,WorkspacesContext_context.H)(),[editor,setEditor]=(0,react.useState)(props.initialEditorField??getRecommandedEditor(editingStatement)),[suggestions,setSuggestions]=(0,react.useState)([]),[displayStatement,setDisplayStatement]=(0,react.useState)([]),[customTemplateEditorVisible,setCustomTemplateEditorVisible]=(0,react.useState)(!1),{addAssumptionLinks,getLinkedAssumptionLinks,removeAssumptionLinks}=(0,context.N)(),{addMitigationLinks,getLinkedMitigationLinks,removeMitigationLinks}=(0,MitigationLinksContext_context.$)(),prevLinkedAssumptionIds=(0,react.useMemo)((()=>getLinkedAssumptionLinks(editingStatement.id).map((la=>la.assumptionId))),[getLinkedAssumptionLinks,editingStatement]),prevLinkedMitigationIds=(0,react.useMemo)((()=>getLinkedMitigationLinks(editingStatement.id).map((lm=>lm.mitigationId))),[getLinkedMitigationLinks,editingStatement]),[linkedAssumptionIds,setLinkedAssumptionIds]=(0,react.useState)(editingStatement&&-1===editingStatement?.numericId?[]:prevLinkedAssumptionIds),[linkedMitigationIds,setLinkedMitigationIds]=(0,react.useState)(editingStatement&&-1===editingStatement?.numericId?[]:prevLinkedMitigationIds),{composerMode}=(0,GlobalSetupContext_context.$)(),{assumptionList,saveAssumption}=(0,AssumptionsContext_context.d)(),{mitigationList,saveMitigation}=(0,MitigationsContext_context.R)(),Component=(0,react.useMemo)((()=>editor&&editorMapping[editor]),[editor]),handleCancel=(0,react.useCallback)((()=>{setEditingStatement(null),onThreatListView?.()}),[setEditingStatement,onThreatListView]);(0,react.useEffect)((()=>{inputRef.current?.focus()}),[editor]),(0,react.useEffect)((()=>{if(editingStatement){const{statement,suggestions:currentSuggestions,displayedStatement}=(0,renderThreatStatement.A)(editingStatement);statement!==editingStatement.statement&&setEditingStatement((prev=>prev&&{...prev,statement,displayedStatement}));const displayedHtml=displayedStatement?.map(((s,index)=>"string"==typeof s?s:"b"===s.type?(0,emotion_react_jsx_runtime_browser_esm.Y)(Tooltip.A,{tooltip:s.tooltip,anchor:"EditorOnly"===composerMode?"bottom":"top",children:(0,emotion_react_jsx_runtime_browser_esm.Y)("b",{css:ThreatStatementEditor_styles.finalStatementSection,children:s.content})},index):"span"===s.type?(0,emotion_react_jsx_runtime_browser_esm.Y)(Tooltip.A,{tooltip:s.tooltip,anchor:"EditorOnly"===composerMode?"bottom":"top",children:(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{css:ThreatStatementEditor_styles.finalStatementSection,children:s.content})},index):(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children:s.content})));setDisplayStatement(displayedHtml),setSuggestions(currentSuggestions)}else setSuggestions([]),setDisplayStatement([])}),[editingStatement,composerMode]);const handleStartOver=(0,react.useCallback)((()=>{setEditingStatement((0,getNewThreatStatement.A)()),setEditor(void 0),fullExamplesRef.current?.collapse()}),[addStatement]),handleComplete=(0,react.useCallback)((()=>{if(editingStatement){saveStatement(editingStatement);const id=editingStatement.id;if(-1===editingStatement.numericId)linkedAssumptionIds&&linkedAssumptionIds.length>0&&addAssumptionLinks(linkedAssumptionIds.map((la=>({assumptionId:la,linkedId:id,type:"Threat"})))),linkedMitigationIds&&linkedMitigationIds.length>0&&addMitigationLinks(linkedMitigationIds.map((lm=>({mitigationId:lm,linkedId:id}))));else{const toAddlinkedAssumptionIds=linkedAssumptionIds.filter((x=>!prevLinkedAssumptionIds.includes(x))),toRemovelinkedAssumptionIds=prevLinkedAssumptionIds.filter((x=>!linkedAssumptionIds.includes(x)));toAddlinkedAssumptionIds&&toAddlinkedAssumptionIds.length>0&&addAssumptionLinks(toAddlinkedAssumptionIds.map((la=>({assumptionId:la,linkedId:id,type:"Threat"})))),toRemovelinkedAssumptionIds&&toRemovelinkedAssumptionIds.length>0&&removeAssumptionLinks(toRemovelinkedAssumptionIds.map((la=>({assumptionId:la,linkedId:id,type:"Threat"}))));const toAddlinkedMitigationIds=linkedMitigationIds.filter((x=>!prevLinkedMitigationIds.includes(x))),toRemovelinkedMitigationIds=prevLinkedMitigationIds.filter((x=>!linkedMitigationIds.includes(x)));toAddlinkedMitigationIds&&toAddlinkedMitigationIds.length>0&&addMitigationLinks(toAddlinkedMitigationIds.map((lm=>({mitigationId:lm,linkedId:id})))),toRemovelinkedMitigationIds&&toRemovelinkedMitigationIds.length>0&&removeMitigationLinks(toRemovelinkedMitigationIds.map((lm=>({mitigationId:lm,linkedId:id}))))}}setEditingStatement(null),onThreatListView?.()}),[saveStatement,editingStatement,linkedAssumptionIds,linkedMitigationIds,prevLinkedAssumptionIds,prevLinkedMitigationIds,onThreatListView]),handleExampleClicked=(0,react.useCallback)((statement=>{setEditingStatement({...statement,...(0,getNewThreatStatement.A)(),tags:[],metadata:[]});const recommendedEditor=getRecommandedEditor(statement);recommendedEditor&&setEditor(recommendedEditor),fullExamplesRef.current?.collapse()}),[]),handleGiveExampleClicked=(0,react.useCallback)((()=>{const len=threatStatementExamples.length,randomNumber=Math.floor(Math.random()*len),statement={...threatStatementExamples[randomNumber],...(0,getNewThreatStatement.A)(),tags:[],metadata:[]};setEditingStatement(statement);const recommendedEditor=getRecommandedEditor(statement);recommendedEditor&&setEditor(recommendedEditor),utils_scrollToTop()}),[]),saveButtonText=(0,react.useMemo)((()=>{if(!currentWorkspace&&0===workspaceList.length)return-1===editingStatement?.numericId?"Add to list":"Save";const workspace=currentWorkspace?.name||constants.L7;return-1===editingStatement?.numericId?`Add to workspace ${workspace}`:`Save to workspace ${workspace}`}),[currentWorkspace,workspaceList,editingStatement]),handleCustomTemplateConfirm=(0,react.useCallback)((template=>{setCustomTemplateEditorVisible(!1),template!==ThreatStatementEditor_defaultThreatStatementFormat.template?setEditingStatement({...editingStatement,customTemplate:template}):setEditingStatement({...editingStatement,customTemplate:void 0})}),[editingStatement]),handleAddAssumptionLink=(0,react.useCallback)((assumptionIdOrNewAssumption=>{if(assumptionList.find((a=>a.id===assumptionIdOrNewAssumption)))setLinkedAssumptionIds((prev=>[...prev,assumptionIdOrNewAssumption]));else{const newAssumption=saveAssumption({id:constants.TN,numericId:-1,content:assumptionIdOrNewAssumption});setLinkedAssumptionIds((prev=>[...prev,newAssumption.id]))}}),[setLinkedAssumptionIds,assumptionList,saveAssumption]),handleAddMitigationLink=(0,react.useCallback)((mitigationIdOrNewMitigation=>{if(mitigationList.find((a=>a.id===mitigationIdOrNewMitigation)))setLinkedMitigationIds((prev=>[...prev,mitigationIdOrNewMitigation]));else{const newMitigation=saveMitigation((0,getNewMitigation.A)(mitigationIdOrNewMitigation));setLinkedMitigationIds((prev=>[...prev,newMitigation.id]))}}),[setLinkedMitigationIds,mitigationList,saveMitigation]),handleAddMitigationsFromMitigationCandidates=(0,react.useCallback)(((mitigationCandidates,threatPackId)=>{mitigationCandidates.forEach((mitigationCandidate=>{const matchMitigation=mitigationList.find((x=>utils_matchThreatPackMitigationCandidate(x,threatPackId,mitigationCandidate.id)));if(matchMitigation)setLinkedMitigationIds((prev=>[...prev,matchMitigation.id]));else{const data={...mitigationCandidate,...(0,getNewMitigation.A)(mitigationCandidate.content),metadata:[...mitigationCandidate.metadata||[],{key:configs.s7,value:configs.jU},{key:configs.jU,value:threatPackId},{key:configs.FY,value:mitigationCandidate.id}]},newMitigation=saveMitigation(data);setLinkedMitigationIds((prev=>[...prev,newMitigation.id]))}}))}),[setLinkedMitigationIds,mitigationList,saveMitigation]),handleEditMetadata=(0,useEditMetadata.A)(setEditingStatement),[threatPackId,threatPackThreatId]=(0,react.useMemo)((()=>{if(props.threatPackId&&props.threatPackThreatId)return[props.threatPackId,props.threatPackThreatId];const metadata=(0,getMetadata.A)(editingStatement.metadata);return[metadata[configs.jU],metadata[configs.UJ]]}),[editingStatement,props]),isExampleVisible=(0,react.useMemo)((()=>-1===editingStatement?.numericId&&!threatPackId),[editingStatement.numericId,threatPackId]);return editingStatement?(0,emotion_react_jsx_runtime_browser_esm.FD)(ContentLayout,{composerMode,saveButtonText,editingStatement,onCancel:handleCancel,onStartOver:isExampleVisible?handleStartOver:void 0,onComplete:handleComplete,children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"vertical",size:"l",children:["ThreatsOnly"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_Header,{composerMode,statement:editingStatement,saveButtonText,onCancel:handleCancel,onStartOver:handleStartOver,onComplete:handleComplete}),(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_FinalStatement,{statement:editingStatement,displayStatement}),(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_FieldSelector,{composerMode,onStartOver:handleStartOver,setEditor,statement:editingStatement,currentEditor:editor,suggestions,onGiveExampleClick:isExampleVisible?handleGiveExampleClicked:void 0,setCustomTemplateEditorVisible}),Component&&editor&&(0,emotion_react_jsx_runtime_browser_esm.FD)(grid.A,{gridDefinition:[{colspan:{default:12,xs:9}},{colspan:{default:12,xs:3}}],children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Component,{ref:inputRef,statement:editingStatement,setStatement:setEditingStatement,fieldData:threatFieldData.A[editor]})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_Metrics,{statement:editingStatement,onClick:token=>setEditor(token)})]}),"Full"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:ThreatStatementEditor_styles.metadataContainer,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(MitigationLinkView.A,{variant:"container",linkedMitigationIds,mitigationList,onAddMitigationLink:handleAddMitigationLink,onRemoveMitigationLink:id=>setLinkedMitigationIds((prev=>prev.filter((p=>p!==id)))),children:(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_MitigationCandidates,{threatPackId,threatPackThreatId,linkedMitigationIds,mitigationList,onAddMitigationsFromMitigationCandidates:handleAddMitigationsFromMitigationCandidates})})}),"Full"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:ThreatStatementEditor_styles.metadataContainer,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(AssumptionLinkView.A,{variant:"container",linkedAssumptionIds,assumptionList,onAddAssumptionLink:handleAddAssumptionLink,onRemoveAssumptionLink:id=>setLinkedAssumptionIds((prev=>prev.filter((p=>p!==id))))})}),"Full"===composerMode&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:ThreatStatementEditor_styles.metadataContainer,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(MetadataEditor.A,{variant:"container",editingStatement,onEditStatementStatus:(_statement,status)=>setEditingStatement((prev=>({...prev,status}))),onEditMetadata:handleEditMetadata})}),isExampleVisible&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_FullExamples,{ref:fullExamplesRef,onClick:handleExampleClicked})]}),customTemplateEditorVisible&&(0,emotion_react_jsx_runtime_browser_esm.Y)(threats_CustomTemplate,{statement:editingStatement,visible:customTemplateEditorVisible,setVisible:setCustomTemplateEditorVisible,onConfirm:handleCustomTemplateConfirm,defaultTemplate:ThreatStatementEditor_defaultThreatStatementFormat.template})]}):(0,emotion_react_jsx_runtime_browser_esm.Y)(text_content.A,{children:"Not threat statement editing in place"})};ThreatStatementEditorInner.displayName="ThreatStatementEditorInner";const ThreatStatementEditor=props=>{const{editingStatement}=(0,ThreatsContext_context.YN)();return editingStatement?(0,emotion_react_jsx_runtime_browser_esm.Y)(ThreatStatementEditorInner,{editingStatement,...props}):null},threats_ThreatStatementEditor=ThreatStatementEditor;try{ThreatStatementEditorInner.displayName="ThreatStatementEditorInner",ThreatStatementEditorInner.__docgenInfo={description:"",displayName:"ThreatStatementEditorInner",props:{onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},threatPackId:{defaultValue:null,description:"",name:"threatPackId",required:!1,type:{name:"string"}},threatPackThreatId:{defaultValue:null,description:"",name:"threatPackThreatId",required:!1,type:{name:"string"}},initialEditorField:{defaultValue:null,description:"",name:"initialEditorField",required:!1,type:{name:"enum",value:[{value:'"prerequisites"'},{value:'"threat_source"'},{value:'"threat_action"'},{value:'"threat_impact"'},{value:'"impacted_goal"'},{value:'"impacted_assets"'}]}},editingStatement:{defaultValue:null,description:"",name:"editingStatement",required:!0,type:{name:"{ id: string; numericId: number; displayOrder?: number | undefined; tags?: string[] | undefined; threatSource?: string | undefined; prerequisites?: string | undefined; threatAction?: string | undefined; ... 7 more ...; status?: string | undefined; }"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/ThreatStatementEditor/index.tsx#ThreatStatementEditorInner"]={docgenInfo:ThreatStatementEditorInner.__docgenInfo,name:"ThreatStatementEditorInner",path:"src/components/threats/ThreatStatementEditor/index.tsx#ThreatStatementEditorInner"})}catch(__react_docgen_typescript_loader_error){}try{ThreatStatementEditor.displayName="ThreatStatementEditor",ThreatStatementEditor.__docgenInfo={description:"",displayName:"ThreatStatementEditor",props:{onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},threatPackId:{defaultValue:null,description:"",name:"threatPackId",required:!1,type:{name:"string"}},threatPackThreatId:{defaultValue:null,description:"",name:"threatPackThreatId",required:!1,type:{name:"string"}},initialEditorField:{defaultValue:null,description:"",name:"initialEditorField",required:!1,type:{name:"enum",value:[{value:'"prerequisites"'},{value:'"threat_source"'},{value:'"threat_action"'},{value:'"threat_impact"'},{value:'"impacted_goal"'},{value:'"impacted_assets"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/threats/ThreatStatementEditor/index.tsx#ThreatStatementEditor"]={docgenInfo:ThreatStatementEditor.__docgenInfo,name:"ThreatStatementEditor",path:"src/components/threats/ThreatStatementEditor/index.tsx#ThreatStatementEditor"})}catch(__react_docgen_typescript_loader_error){}}}]);
//# sourceMappingURL=5717.7cfca6d6.iframe.bundle.js.map