"use strict";(self.webpackChunk_aws_threat_composer=self.webpackChunk_aws_threat_composer||[]).push([[100],{"./src/components/generic/ContentLayout/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _cloudscape_design_components_content_layout__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@cloudscape-design/components/content-layout/index.js"),_cloudscape_design_components_header__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@cloudscape-design/components/header/index.js"),_contexts_ApplicationContext__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/contexts/ApplicationContext/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const ContentLayout=({title,children,...props})=>{const{applicationInfo}=(0,_contexts_ApplicationContext__WEBPACK_IMPORTED_MODULE_0__.b)();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_content_layout__WEBPACK_IMPORTED_MODULE_2__.A,{headerVariant:"high-contrast",header:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_cloudscape_design_components_header__WEBPACK_IMPORTED_MODULE_3__.A,{variant:"h1",...props,info:applicationInfo.name?`| ${applicationInfo.name}`:void 0,children:title}),children})};ContentLayout.displayName="ContentLayout";const __WEBPACK_DEFAULT_EXPORT__=ContentLayout;try{ContentLayout.displayName="ContentLayout",ContentLayout.__docgenInfo={description:"",displayName:"ContentLayout",props:{title:{defaultValue:null,description:"The title of the header.",name:"title",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/ContentLayout/index.tsx#ContentLayout"]={docgenInfo:ContentLayout.__docgenInfo,name:"ContentLayout",path:"src/components/generic/ContentLayout/index.tsx#ContentLayout"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/workspaces/WorkspaceInsights/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>workspaces_WorkspaceInsights});var board=__webpack_require__("../../node_modules/@cloudscape-design/board-components/board/index.js"),board_item=__webpack_require__("../../node_modules/@cloudscape-design/board-components/board-item/index.js"),header=__webpack_require__("../../node_modules/@cloudscape-design/components/header/index.js"),react=__webpack_require__("../../node_modules/react/index.js"),column_layout=__webpack_require__("../../node_modules/@cloudscape-design/components/column-layout/index.js"),box=__webpack_require__("../../node_modules/@cloudscape-design/components/box/index.js"),components_button=__webpack_require__("../../node_modules/@cloudscape-design/components/button/index.js"),pie_chart=__webpack_require__("../../node_modules/@cloudscape-design/components/pie-chart/index.js"),design_tokens=__webpack_require__("../../node_modules/@cloudscape-design/design-tokens/index.js"),configs=__webpack_require__("./src/configs/index.ts"),MitigationsContext=__webpack_require__("./src/contexts/MitigationsContext/index.tsx"),threatStatus=__webpack_require__("./src/data/status/threatStatus.json"),mitigationStatus=__webpack_require__("./src/data/status/mitigationStatus.json"),icon=__webpack_require__("../../node_modules/@cloudscape-design/components/icon/index.js"),components_link=__webpack_require__("../../node_modules/@cloudscape-design/components/link/index.js"),space_between=__webpack_require__("../../node_modules/@cloudscape-design/components/space-between/index.js"),emotion_react_browser_esm=__webpack_require__("../../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("../../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const styles={link:(0,emotion_react_browser_esm.AH)({"& a":{textDecoration:"none !important"}})},DashboardNumber=({showWarning,featuredNumber,totalNumber,onLinkClicked})=>(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:styles.link,children:showWarning&&(totalNumber?featuredNumber<totalNumber:featuredNumber>0)?(0,emotion_react_jsx_runtime_browser_esm.FD)(space_between.A,{direction:"horizontal",size:"xxs",children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_link.A,{variant:"awsui-value-large",href:"#",onFollow:onLinkClicked,children:totalNumber?`${featuredNumber}/${totalNumber}`:featuredNumber}),(0,emotion_react_jsx_runtime_browser_esm.Y)(icon.A,{name:"status-warning",variant:"warning"})]}):(0,emotion_react_jsx_runtime_browser_esm.Y)(components_link.A,{variant:"awsui-value-large",href:"#",onFollow:onLinkClicked,children:totalNumber?`${featuredNumber}/${totalNumber}`:featuredNumber})});DashboardNumber.displayName="DashboardNumber";const generic_DashboardNumber=DashboardNumber;try{DashboardNumber.displayName="DashboardNumber",DashboardNumber.__docgenInfo={description:"",displayName:"DashboardNumber",props:{featuredNumber:{defaultValue:null,description:"",name:"featuredNumber",required:!0,type:{name:"number"}},totalNumber:{defaultValue:null,description:"",name:"totalNumber",required:!1,type:{name:"number"}},showWarning:{defaultValue:null,description:"",name:"showWarning",required:!1,type:{name:"boolean"}},onLinkClicked:{defaultValue:null,description:"",name:"onLinkClicked",required:!1,type:{name:"CancelableEventHandler<BaseNavigationDetail>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/generic/DashboardNumber/index.tsx#DashboardNumber"]={docgenInfo:DashboardNumber.__docgenInfo,name:"DashboardNumber",path:"src/components/generic/DashboardNumber/index.tsx#DashboardNumber"})}catch(__react_docgen_typescript_loader_error){}const useMitigationListLinkClicked=onMitigationListView=>(0,react.useCallback)((filter=>event=>{event?.preventDefault?.(),onMitigationListView?.(filter)}),[onMitigationListView]),hooks_useMitigationListLinkClicked=useMitigationListLinkClicked;try{useMitigationListLinkClicked.displayName="useMitigationListLinkClicked",useMitigationListLinkClicked.__docgenInfo={description:"",displayName:"useMitigationListLinkClicked",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/hooks/useMitigationListLinkClicked/index.tsx#useMitigationListLinkClicked"]={docgenInfo:useMitigationListLinkClicked.__docgenInfo,name:"useMitigationListLinkClicked",path:"src/components/workspaces/WorkspaceInsights/hooks/useMitigationListLinkClicked/index.tsx#useMitigationListLinkClicked"})}catch(__react_docgen_typescript_loader_error){}var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const MitigationStatus=({onMitigationListView})=>{const{mitigationList}=(0,MitigationsContext.R)(),handleLinkClicked=hooks_useMitigationListLinkClicked(onMitigationListView),countNotSet=(0,react.useMemo)((()=>mitigationList.filter((x=>!x.status)).length),[mitigationList]),countIdentified=(0,react.useMemo)((()=>mitigationList.filter((x=>x.status===configs.D4)).length),[mitigationList]),countResolved=(0,react.useMemo)((()=>mitigationList.filter((x=>x.status===configs.yb)).length),[mitigationList]),countInProgress=(0,react.useMemo)((()=>mitigationList.filter((x=>x.status===configs.Tr)).length),[mitigationList]),countWillNotAction=(0,react.useMemo)((()=>mitigationList.filter((x=>x.status===configs.u1)).length),[mitigationList]),handleAddMitigation=(0,react.useCallback)((()=>{onMitigationListView?.()}),[mitigationList,onMitigationListView]);return(0,jsx_runtime.jsxs)(column_layout.A,{columns:1,borders:"horizontal",children:[mitigationList.length?(0,jsx_runtime.jsx)(box.A,{padding:"s",children:(0,jsx_runtime.jsx)(pie_chart.A,{data:[{title:mitigationStatus.find((x=>x.value===configs.yb))?.label||"Resolved",value:countResolved,color:design_tokens.qMx},{title:mitigationStatus.find((x=>x.value===configs.u1))?.label||"Will not action",value:countWillNotAction,color:design_tokens.fYR},{title:mitigationStatus.find((x=>x.value===configs.Tr))?.label||"In-progress",value:countInProgress,color:design_tokens.pvt},{title:mitigationStatus.find((x=>x.value===configs.D4))?.label||"Identified",value:countIdentified,color:design_tokens.i5p},{title:"Not Set",value:countNotSet,color:design_tokens.h9$}],detailPopoverContent:(datum,sum)=>[{key:"Mitigation count",value:datum.value},{key:"Percentage",value:`${(datum.value/sum*100).toFixed(0)}%`}],segmentDescription:(datum,sum)=>`${datum.value} mitigations, ${(datum.value/sum*100).toFixed(0)}%`,ariaDescription:"Pie chart showing the status of mitigations.",ariaLabel:"Pie chart",hideFilter:!0,innerMetricDescription:"Mitigations",innerMetricValue:mitigationList.length.toString(),variant:"donut",size:"medium",noMatch:(0,jsx_runtime.jsxs)(box.A,{textAlign:"center",color:"inherit",children:[(0,jsx_runtime.jsx)("b",{children:"No matching data"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"inherit",children:"There is no matching data to display"}),(0,jsx_runtime.jsx)(components_button.A,{children:"Clear filter"})]})})}):(0,jsx_runtime.jsxs)(box.A,{margin:"xxl",padding:"xxl",color:"text-body-secondary",textAlign:"center",children:[(0,jsx_runtime.jsx)("b",{children:"No mitigations available"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"text-body-secondary",children:"Start by adding a mitigation to this workspace"}),(0,jsx_runtime.jsx)(components_button.A,{variant:"primary",onClick:()=>handleAddMitigation(),children:"Add a mitigation"})]}),countNotSet>0?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(box.A,{variant:"awsui-key-label",children:"Missing status"}),(0,jsx_runtime.jsx)(generic_DashboardNumber,{showWarning:!0,featuredNumber:countNotSet,onLinkClicked:handleLinkClicked({status:[configs.gK]})})]}):null]})};MitigationStatus.displayName="MitigationStatus";const components_MitigationStatus=MitigationStatus;try{MitigationStatus.displayName="MitigationStatus",MitigationStatus.__docgenInfo={description:"",displayName:"MitigationStatus",props:{onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string, idToCopy?: string) => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"((filter?: MitigationListFilter) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/components/MitigationStatus/index.tsx#MitigationStatus"]={docgenInfo:MitigationStatus.__docgenInfo,name:"MitigationStatus",path:"src/components/workspaces/WorkspaceInsights/components/MitigationStatus/index.tsx#MitigationStatus"})}catch(__react_docgen_typescript_loader_error){}var badge=__webpack_require__("../../node_modules/@cloudscape-design/components/badge/index.js"),contexts=__webpack_require__("./src/contexts/index.ts"),MitigationLinksContext=__webpack_require__("./src/contexts/MitigationLinksContext/index.tsx"),ThreatsContext=__webpack_require__("./src/contexts/ThreatsContext/index.tsx");const utils_filterThreatsByMetadata=(threatList,metadataKey,metadataValue)=>metadataValue===configs.os?threatList:metadataValue?threatList.filter((s=>{if(!s.metadata)return!1;const metadata=s.metadata.find((m=>m.key===metadataKey));return!(!metadata||!metadata.value)&&(Array.isArray(metadata.value)?metadata.value.includes(metadataValue):metadata.value===metadataValue)})):threatList.filter((s=>{if(!s.metadata)return!0;const metadata=s.metadata.find((m=>m.key===metadataKey));return!metadata||!metadata.value||!(!Array.isArray(metadata.value)||0!==metadata.value.length)})),useThreatListLinkClicked=onThreatListView=>(0,react.useCallback)((filter=>event=>{event?.preventDefault?.(),onThreatListView?.(filter)}),[onThreatListView]),hooks_useThreatListLinkClicked=useThreatListLinkClicked;try{useThreatListLinkClicked.displayName="useThreatListLinkClicked",useThreatListLinkClicked.__docgenInfo={description:"",displayName:"useThreatListLinkClicked",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/hooks/useThreatListLinkClicked/index.tsx#useThreatListLinkClicked"]={docgenInfo:useThreatListLinkClicked.__docgenInfo,name:"useThreatListLinkClicked",path:"src/components/workspaces/WorkspaceInsights/hooks/useThreatListLinkClicked/index.tsx#useThreatListLinkClicked"})}catch(__react_docgen_typescript_loader_error){}const Overview_styles={container:(0,emotion_react_browser_esm.AH)({height:"100%",display:"flex",flexDirection:"column"}),contentContainer:(0,emotion_react_browser_esm.AH)({flex:1,display:"flex",alignItems:"flex-end"})},LabelValuePair=({label,value,totalValue,onLinkFollow,showWarning})=>(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{css:Overview_styles.container,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(box.A,{variant:"awsui-key-label",children:label}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{css:Overview_styles.contentContainer,children:(0,emotion_react_jsx_runtime_browser_esm.Y)(generic_DashboardNumber,{showWarning,featuredNumber:value,totalNumber:totalValue,onLinkClicked:onLinkFollow})})]});LabelValuePair.displayName="LabelValuePair";const Overview=({onThreatListView,onMitigationListView})=>{const{statementList}=(0,ThreatsContext.Y)(),{mitigationList}=(0,contexts.RV)(),{mitigationLinkList}=(0,MitigationLinksContext.$)(),{assumptionLinkList}=(0,contexts.NN)(),missingMitigationOrAssumption=(0,react.useMemo)((()=>statementList.filter((s=>!mitigationLinkList.find((ml=>ml.linkedId===s.id))&&!assumptionLinkList.find((al=>al.linkedId===s.id)))).length),[statementList,mitigationLinkList,assumptionLinkList]),handleThreatListLinkClicked=hooks_useThreatListLinkClicked(onThreatListView),handleMitigationListLinkClicked=hooks_useMitigationListLinkClicked(onMitigationListView),missingMitigation=(0,react.useMemo)((()=>statementList.filter((s=>!mitigationLinkList.find((ml=>ml.linkedId===s.id)))).length),[statementList,mitigationLinkList]),missingPriority=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority").length),[statementList]),[completedMitigations,totalMitigations]=(0,react.useMemo)((()=>[mitigationList.filter((m=>m.status===configs.yb||m.status===configs.u1)).length,mitigationList.length]),[mitigationList]),[completedThreats,totalThreats]=(0,react.useMemo)((()=>[statementList.filter((st=>st.status===configs.tU||st.status===configs.fv)).length,statementList.length]),[mitigationList]),countHigh=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority",configs.Mc).length),[statementList]),countMed=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority","Medium").length),[statementList]),countLow=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority","Low").length),[statementList]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(column_layout.A,{columns:7,variant:"text-grid",minColumnWidth:120,children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:"Total",value:statementList.length,onLinkFollow:handleThreatListLinkClicked()}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:"No mitigation and assumption",showWarning:!0,value:missingMitigationOrAssumption,onLinkFollow:handleThreatListLinkClicked({linkedMitigations:!1,linkedAssumptions:!1})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:"No mitigation",showWarning:!0,value:missingMitigation,onLinkFollow:handleThreatListLinkClicked({linkedMitigations:!1})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:(0,emotion_react_jsx_runtime_browser_esm.Y)(badge.A,{color:"red",children:"High"}),value:countHigh,onLinkFollow:handleThreatListLinkClicked({priority:configs.Mc})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:(0,emotion_react_jsx_runtime_browser_esm.Y)(badge.A,{color:"blue",children:"Med"}),value:countMed,onLinkFollow:handleThreatListLinkClicked({priority:configs.jn})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:(0,emotion_react_jsx_runtime_browser_esm.Y)(badge.A,{color:"green",children:"Low"}),value:countLow,onLinkFollow:handleThreatListLinkClicked({priority:configs.ui})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:"Missing priority",showWarning:!0,value:missingPriority,onLinkFollow:handleThreatListLinkClicked({priority:configs.gv})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:"Threat progress",showWarning:!0,value:completedThreats,totalValue:totalThreats,onLinkFollow:handleThreatListLinkClicked({status:[configs.gK,configs.U3]})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LabelValuePair,{label:"Mitigation progress",showWarning:!0,value:completedMitigations,totalValue:totalMitigations,onLinkFollow:handleMitigationListLinkClicked({status:[configs.gK,configs.Tr,configs.D4]})})]})};Overview.displayName="Overview";const components_Overview=Overview;try{Overview.displayName="Overview",Overview.__docgenInfo={description:"",displayName:"Overview",props:{onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string, idToCopy?: string) => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"((filter?: MitigationListFilter) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/components/Overview/index.tsx#Overview"]={docgenInfo:Overview.__docgenInfo,name:"Overview",path:"src/components/workspaces/WorkspaceInsights/components/Overview/index.tsx#Overview"})}catch(__react_docgen_typescript_loader_error){}var form_field=__webpack_require__("../../node_modules/@cloudscape-design/components/form-field/index.js"),components_select=__webpack_require__("../../node_modules/@cloudscape-design/components/select/index.js"),bar_chart=__webpack_require__("../../node_modules/@cloudscape-design/components/bar-chart/index.js");const STRIDEAllocation=({onThreatEditorView,onThreatListView})=>{const{statementList,addStatement}=(0,ThreatsContext.Y)(),[selectedPriority,setSelectedPriority]=(0,react.useState)(configs.os),filteredStatementList=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority",selectedPriority)),[statementList,selectedPriority]),handleAddStatement=(0,react.useCallback)((()=>{addStatement(),onThreatEditorView?.(configs.TN)}),[addStatement,onThreatEditorView]),missingStride=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(filteredStatementList,"STRIDE").length),[filteredStatementList]),countSpoofing=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(filteredStatementList,"STRIDE","S").length),[filteredStatementList]),countTampering=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(filteredStatementList,"STRIDE","T").length),[filteredStatementList]),countRepudiation=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(filteredStatementList,"STRIDE","R").length),[filteredStatementList]),countInformationDisclosure=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(filteredStatementList,"STRIDE","I").length),[filteredStatementList]),countDenialOfService=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(filteredStatementList,"STRIDE","D").length),[filteredStatementList]),countElevationOfPrivilege=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(filteredStatementList,"STRIDE","E").length),[filteredStatementList]),handleLinkClicked=hooks_useThreatListLinkClicked(onThreatListView),barSeries=[{title:"Spoofing",type:"bar",data:[{x:"Spoofing",y:countSpoofing}]},{title:"Tampering",type:"bar",data:[{x:"Tampering",y:countTampering}]},{title:"Repudiation",type:"bar",data:[{x:"Repudiation",y:countRepudiation}]},{title:"Information disclosure",type:"bar",data:[{x:"Information disclosure",y:countInformationDisclosure}]},{title:"Denial of service",type:"bar",data:[{x:"Denial of Service",y:countDenialOfService}]},{title:"Elevation of Privilege",type:"bar",data:[{x:"Elevation of Privilege",y:countElevationOfPrivilege}]}];return(0,jsx_runtime.jsxs)(column_layout.A,{columns:1,borders:"horizontal",children:[statementList.length?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(form_field.A,{label:"Filter by threat priority",children:(0,jsx_runtime.jsx)(components_select.A,{selectedOption:configs.ce.find((x=>x.value===selectedPriority))||null,onChange:({detail})=>{setSelectedPriority(detail.selectedOption.value)},options:configs.ce})}),filteredStatementList.length?(0,jsx_runtime.jsx)(box.A,{padding:"s",children:(0,jsx_runtime.jsx)(bar_chart.A,{series:barSeries,ariaLabel:"Threat category allocation chart",emphasizeBaselineAxis:!1,height:280,hideFilter:!0,hideLegend:!0,horizontalBars:!0,stackedBars:!0,noMatch:(0,jsx_runtime.jsxs)(box.A,{textAlign:"center",color:"inherit",children:[(0,jsx_runtime.jsx)("b",{children:"No matching data"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"inherit",children:"There is no matching data to display"}),(0,jsx_runtime.jsx)(components_button.A,{children:"Clear filter"})]})})}):(0,jsx_runtime.jsx)(box.A,{margin:"xxl",padding:"xxl",color:"text-body-secondary",textAlign:"center",children:(0,jsx_runtime.jsx)("b",{children:"No threats meet the filter criteria"})})]}):(0,jsx_runtime.jsxs)(box.A,{margin:"xxl",padding:"xxl",color:"text-body-secondary",textAlign:"center",children:[(0,jsx_runtime.jsx)("b",{children:"No threats available"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"text-body-secondary",children:"Start by adding a threat to this workspace"}),(0,jsx_runtime.jsx)(components_button.A,{variant:"primary",onClick:()=>handleAddStatement(),children:"Add a threat"})]}),missingStride>0?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(box.A,{variant:"awsui-key-label",children:"Missing STRIDE"}),(0,jsx_runtime.jsx)(generic_DashboardNumber,{showWarning:!0,featuredNumber:missingStride,onLinkClicked:handleLinkClicked({stride:configs.gv})})]}):null]})};STRIDEAllocation.displayName="STRIDEAllocation";const components_STRIDEAllocation=STRIDEAllocation;try{STRIDEAllocation.displayName="STRIDEAllocation",STRIDEAllocation.__docgenInfo={description:"",displayName:"STRIDEAllocation",props:{onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string, idToCopy?: string) => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"((filter?: MitigationListFilter) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/components/STRIDEAllocation/index.tsx#STRIDEAllocation"]={docgenInfo:STRIDEAllocation.__docgenInfo,name:"STRIDEAllocation",path:"src/components/workspaces/WorkspaceInsights/components/STRIDEAllocation/index.tsx#STRIDEAllocation"})}catch(__react_docgen_typescript_loader_error){}const ThreatGrammar=({onThreatEditorView})=>{const{statementList,addStatement}=(0,ThreatsContext.Y)(),[selectedPriority,setSelectedPriority]=(0,react.useState)(configs.os),filteredStatementList=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority",selectedPriority)),[statementList,selectedPriority]),handleAddStatement=(0,react.useCallback)((()=>{addStatement(),onThreatEditorView?.(configs.TN)}),[addStatement,onThreatEditorView]),countThreatSource=(0,react.useMemo)((()=>filteredStatementList.filter((s=>s.threatSource)).length),[filteredStatementList]),countPrerequisites=(0,react.useMemo)((()=>filteredStatementList.filter((s=>s.prerequisites)).length),[filteredStatementList]),countThreatAction=(0,react.useMemo)((()=>filteredStatementList.filter((s=>s.threatAction)).length),[filteredStatementList]),countThreatImpact=(0,react.useMemo)((()=>filteredStatementList.filter((s=>s.threatImpact)).length),[filteredStatementList]),countImpactedGoal=(0,react.useMemo)((()=>filteredStatementList.filter((s=>s.impactedGoal&&0!=s.impactedGoal?.length)).length),[filteredStatementList]),countImpactedAssets=(0,react.useMemo)((()=>filteredStatementList.filter((s=>s.impactedAssets&&0!=s.impactedAssets?.length)).length),[filteredStatementList]),notUsingGrammar=(0,react.useMemo)((()=>filteredStatementList.filter((s=>!(s.threatSource||s.prerequisites||s.threatAction||s.threatImpact||s.impactedGoal?.length||s.impactedAssets?.length))).length),[filteredStatementList]);let barSeries=[{title:"Inputs for mitigation",type:"bar",data:[{x:"Threat source",y:countThreatSource},{x:"Prerequisites",y:countPrerequisites},{x:"Threat action",y:countThreatAction}],color:design_tokens.EAf},{title:"Inputs for prioritisation",type:"bar",data:[{x:"Threat impact",y:countThreatImpact},{x:"Impacted goal",y:countImpactedGoal},{x:"Impacted assets",y:countImpactedAssets}],color:design_tokens.xhe}];return(0,jsx_runtime.jsxs)(column_layout.A,{columns:1,borders:"horizontal",children:[statementList.length?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(form_field.A,{label:"Filter by threat priority",children:(0,jsx_runtime.jsx)(components_select.A,{selectedOption:configs.ce.find((x=>x.value===selectedPriority))||null,onChange:({detail})=>{setSelectedPriority(detail.selectedOption.value)},options:configs.ce})}),filteredStatementList.length?(0,jsx_runtime.jsx)(box.A,{padding:"s",children:(0,jsx_runtime.jsx)(bar_chart.A,{series:barSeries,ariaLabel:"Threat Grammer Chart",emphasizeBaselineAxis:!1,height:245,hideFilter:!0,horizontalBars:!0,stackedBars:!0,noMatch:(0,jsx_runtime.jsxs)(box.A,{textAlign:"center",color:"inherit",children:[(0,jsx_runtime.jsx)("b",{children:"No matching data"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"inherit",children:"There is no matching data to display"}),(0,jsx_runtime.jsx)(components_button.A,{children:"Clear filter"})]})})}):(0,jsx_runtime.jsx)(box.A,{margin:"xxl",padding:"xxl",color:"text-body-secondary",textAlign:"center",children:(0,jsx_runtime.jsx)("b",{children:"No threats meet the filter criteria"})})]}):(0,jsx_runtime.jsxs)(box.A,{margin:"xxl",padding:"xxl",color:"text-body-secondary",textAlign:"center",children:[(0,jsx_runtime.jsx)("b",{children:"No threats available"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"text-body-secondary",children:"Start by adding a threat to this workspace"}),(0,jsx_runtime.jsx)(components_button.A,{variant:"primary",onClick:()=>handleAddStatement(),children:"Add a threat"})]}),notUsingGrammar>0?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(box.A,{variant:"awsui-key-label",children:"Not using grammar"}),(0,jsx_runtime.jsx)(generic_DashboardNumber,{showWarning:!0,featuredNumber:notUsingGrammar})]}):null]})};ThreatGrammar.displayName="ThreatGrammar";const components_ThreatGrammar=ThreatGrammar;try{ThreatGrammar.displayName="ThreatGrammar",ThreatGrammar.__docgenInfo={description:"",displayName:"ThreatGrammar",props:{onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string, idToCopy?: string) => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"((filter?: MitigationListFilter) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/components/ThreatGrammar/index.tsx#ThreatGrammar"]={docgenInfo:ThreatGrammar.__docgenInfo,name:"ThreatGrammar",path:"src/components/workspaces/WorkspaceInsights/components/ThreatGrammar/index.tsx#ThreatGrammar"})}catch(__react_docgen_typescript_loader_error){}const ThreatPrioritization=({onThreatEditorView,onThreatListView})=>{const{statementList,addStatement}=(0,ThreatsContext.Y)(),handleLinkClicked=hooks_useThreatListLinkClicked(onThreatListView),missingPriority=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority").length),[statementList]),countHigh=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority",configs.Mc).length),[statementList]),countMed=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority",configs.jn).length),[statementList]),countLow=(0,react.useMemo)((()=>utils_filterThreatsByMetadata(statementList,"Priority",configs.ui).length),[statementList]),handleAddStatement=(0,react.useCallback)((()=>{addStatement(),onThreatEditorView?.(configs.TN)}),[addStatement,onThreatEditorView]);return(0,jsx_runtime.jsxs)(column_layout.A,{columns:1,borders:"horizontal",children:[statementList.length?(0,jsx_runtime.jsx)(box.A,{padding:"s",children:(0,jsx_runtime.jsx)(pie_chart.A,{data:[{title:"High",value:countHigh,color:design_tokens.h9$},{title:"Medium",value:countMed,color:design_tokens.pvt},{title:"Low",value:countLow,color:design_tokens.qMx},{title:"Undefined",value:missingPriority,color:design_tokens.i5p}],detailPopoverContent:(datum,sum)=>[{key:"Threat count",value:datum.value},{key:"Percentage",value:`${(datum.value/sum*100).toFixed(0)}%`}],segmentDescription:(datum,sum)=>`${datum.value} threats, ${(datum.value/sum*100).toFixed(0)}%`,ariaDescription:"Pie chart showing the prioritization of threats.",ariaLabel:"Pie chart",hideFilter:!0,innerMetricDescription:"Threats",innerMetricValue:statementList.length.toString(),variant:"donut",size:"medium",noMatch:(0,jsx_runtime.jsxs)(box.A,{textAlign:"center",color:"inherit",children:[(0,jsx_runtime.jsx)("b",{children:"No matching data"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"inherit",children:"There is no matching data to display"}),(0,jsx_runtime.jsx)(components_button.A,{children:"Clear filter"})]})})}):(0,jsx_runtime.jsxs)(box.A,{margin:"xxl",padding:"xxl",color:"text-body-secondary",textAlign:"center",children:[(0,jsx_runtime.jsx)("b",{children:"No threats available"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"text-body-secondary",children:"Start by adding a threat to this workspace"}),(0,jsx_runtime.jsx)(components_button.A,{variant:"primary",onClick:()=>handleAddStatement(),children:"Add a threat"})]}),missingPriority>0?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(box.A,{variant:"awsui-key-label",children:"Missing priority"}),(0,jsx_runtime.jsx)(generic_DashboardNumber,{showWarning:!0,featuredNumber:missingPriority,onLinkClicked:handleLinkClicked({priority:configs.gv})})]}):null]})};ThreatPrioritization.displayName="ThreatPrioritization";const components_ThreatPrioritization=ThreatPrioritization;try{ThreatPrioritization.displayName="ThreatPrioritization",ThreatPrioritization.__docgenInfo={description:"",displayName:"ThreatPrioritization",props:{onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string, idToCopy?: string) => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"((filter?: MitigationListFilter) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/components/ThreatPrioritization/index.tsx#ThreatPrioritization"]={docgenInfo:ThreatPrioritization.__docgenInfo,name:"ThreatPrioritization",path:"src/components/workspaces/WorkspaceInsights/components/ThreatPrioritization/index.tsx#ThreatPrioritization"})}catch(__react_docgen_typescript_loader_error){}const ThreatStatus=({onThreatEditorView,onThreatListView})=>{const{statementList,addStatement}=(0,ThreatsContext.Y)(),handleLinkClicked=hooks_useThreatListLinkClicked(onThreatListView),countNotSet=(0,react.useMemo)((()=>statementList.filter((x=>!x.status)).length),[statementList]),countIdentified=(0,react.useMemo)((()=>statementList.filter((x=>x.status===configs.U3)).length),[statementList]),countResolved=(0,react.useMemo)((()=>statementList.filter((x=>x.status===configs.fv)).length),[statementList]),countNotUseful=(0,react.useMemo)((()=>statementList.filter((x=>x.status===configs.tU)).length),[statementList]),handleAddStatement=(0,react.useCallback)((()=>{addStatement(),onThreatEditorView?.(configs.TN)}),[addStatement,onThreatEditorView]);return(0,jsx_runtime.jsxs)(column_layout.A,{columns:1,borders:"horizontal",children:[statementList.length?(0,jsx_runtime.jsx)(box.A,{padding:"s",children:(0,jsx_runtime.jsx)(pie_chart.A,{data:[{title:threatStatus.find((x=>x.value===configs.fv))?.label||"Resolved",value:countResolved,color:design_tokens.qMx},{title:threatStatus.find((x=>x.value===configs.tU))?.label||"Not useful",value:countNotUseful,color:design_tokens.pvt},{title:threatStatus.find((x=>x.value===configs.U3))?.label||"Identified",value:countIdentified,color:design_tokens.i5p},{title:"Not Set",value:countNotSet,color:design_tokens.h9$}],detailPopoverContent:(datum,sum)=>[{key:"Threat count",value:datum.value},{key:"Percentage",value:`${(datum.value/sum*100).toFixed(0)}%`}],segmentDescription:(datum,sum)=>`${datum.value} threats, ${(datum.value/sum*100).toFixed(0)}%`,ariaDescription:"Pie chart showing the status of threats.",ariaLabel:"Pie chart",hideFilter:!0,innerMetricDescription:"Threats",innerMetricValue:statementList.length.toString(),variant:"donut",size:"medium",noMatch:(0,jsx_runtime.jsxs)(box.A,{textAlign:"center",color:"inherit",children:[(0,jsx_runtime.jsx)("b",{children:"No matching data"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"inherit",children:"There is no matching data to display"}),(0,jsx_runtime.jsx)(components_button.A,{children:"Clear filter"})]})})}):(0,jsx_runtime.jsxs)(box.A,{margin:"xxl",padding:"xxl",color:"text-body-secondary",textAlign:"center",children:[(0,jsx_runtime.jsx)("b",{children:"No threats available"}),(0,jsx_runtime.jsx)(box.A,{variant:"p",color:"text-body-secondary",children:"Start by adding a threat to this workspace"}),(0,jsx_runtime.jsx)(components_button.A,{variant:"primary",onClick:()=>handleAddStatement(),children:"Add a threat"})]}),countNotSet>0?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(box.A,{variant:"awsui-key-label",children:"Missing status"}),(0,jsx_runtime.jsx)(generic_DashboardNumber,{showWarning:!0,featuredNumber:countNotSet,onLinkClicked:handleLinkClicked({status:[configs.gK]})})]}):null]})};ThreatStatus.displayName="ThreatStatus";const components_ThreatStatus=ThreatStatus;try{ThreatStatus.displayName="ThreatStatus",ThreatStatus.__docgenInfo={description:"",displayName:"ThreatStatus",props:{onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string, idToCopy?: string) => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"((filter?: MitigationListFilter) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/components/ThreatStatus/index.tsx#ThreatStatus"]={docgenInfo:ThreatStatus.__docgenInfo,name:"ThreatStatus",path:"src/components/workspaces/WorkspaceInsights/components/ThreatStatus/index.tsx#ThreatStatus"})}catch(__react_docgen_typescript_loader_error){}var ContentLayout=__webpack_require__("./src/components/generic/ContentLayout/index.tsx");const WorkspaceInsights=props=>{const[items,setItems]=(0,react.useState)([{id:"overview",rowSpan:3,columnSpan:6,data:{title:"Threat summary",content:(0,jsx_runtime.jsx)(components_Overview,{...props})}},{id:"threat-prioritization",rowSpan:5,columnSpan:2,data:{title:"Threat prioritization",content:(0,jsx_runtime.jsx)(components_ThreatPrioritization,{...props})}},{id:"threat-status",rowSpan:5,columnSpan:2,data:{title:"Threat status",content:(0,jsx_runtime.jsx)(components_ThreatStatus,{...props})}},{id:"stride-allocation",rowSpan:5,columnSpan:2,data:{title:"Threat category distribution",content:(0,jsx_runtime.jsx)(components_STRIDEAllocation,{...props})}},{id:"threat-grammer",rowSpan:5,columnSpan:2,data:{title:"Threat grammar distribution",content:(0,jsx_runtime.jsx)(components_ThreatGrammar,{...props})}},{id:"mitigation-status",rowSpan:5,columnSpan:2,data:{title:"Mitigation status",content:(0,jsx_runtime.jsx)(components_MitigationStatus,{...props})}}]),handleRenderItem=(0,react.useCallback)(((item,_actions)=>(0,jsx_runtime.jsx)(board_item.A,{header:(0,jsx_runtime.jsx)(header.A,{children:item.data.title}),i18nStrings:{dragHandleAriaLabel:"Drag handle",dragHandleAriaDescription:"Use Space or Enter to activate drag, arrow keys to move, Space or Enter to submit, or Escape to discard.",resizeHandleAriaLabel:"Resize handle",resizeHandleAriaDescription:"Use Space or Enter to activate resize, arrow keys to move, Space or Enter to submit, or Escape to discard."},children:item.data.content})),[]);return(0,jsx_runtime.jsx)(ContentLayout.A,{title:"Insights dashboard",children:(0,jsx_runtime.jsx)(board.A,{renderItem:handleRenderItem,onItemsChange:event=>{setItems(event.detail.items)},empty:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}),items,i18nStrings:(()=>{function createAnnouncement(operationAnnouncement,conflicts,disturbed){return[operationAnnouncement,conflicts.length>0?`Conflicts with ${conflicts.map((c=>c.data.title)).join(", ")}.`:"",disturbed.length>0?`Disturbed ${disturbed.length} items.`:""].filter(Boolean).join(" ")}return{liveAnnouncementDndStarted:operationType=>"resize"===operationType?"Resizing":"Dragging",liveAnnouncementDndItemReordered:operation=>{const columns=`column ${operation.placement.x+1}`,rows=`row ${operation.placement.y+1}`;return createAnnouncement(`Item moved to ${"horizontal"===operation.direction?columns:rows}.`,operation.conflicts,operation.disturbed)},liveAnnouncementDndItemResized:operation=>{const columnsConstraint=operation.isMinimalColumnsReached?" (minimal)":"",rowsConstraint=operation.isMinimalRowsReached?" (minimal)":"";return createAnnouncement(`Item resized to ${"horizontal"===operation.direction?`columns ${operation.placement.width}${columnsConstraint}`:`rows ${operation.placement.height}${rowsConstraint}`}.`,operation.conflicts,operation.disturbed)},liveAnnouncementDndItemInserted:operation=>createAnnouncement(`Item inserted to ${`column ${operation.placement.x+1}`}, ${`row ${operation.placement.y+1}`}.`,operation.conflicts,operation.disturbed),liveAnnouncementDndCommitted:operationType=>`${operationType} committed`,liveAnnouncementDndDiscarded:operationType=>`${operationType} discarded`,liveAnnouncementItemRemoved:op=>createAnnouncement(`Removed item ${op.item.data.title}.`,[],op.disturbed),navigationAriaLabel:"Board navigation",navigationAriaDescription:"Click on non-empty item to move focus over",navigationItemAriaLabel:item=>item?item.data.title:"Empty"}})()})})};WorkspaceInsights.displayName="WorkspaceInsights";const workspaces_WorkspaceInsights=WorkspaceInsights;try{WorkspaceInsights.displayName="WorkspaceInsights",WorkspaceInsights.__docgenInfo={description:"",displayName:"WorkspaceInsights",props:{onThreatEditorView:{defaultValue:null,description:"",name:"onThreatEditorView",required:!1,type:{name:"((threatId: string, idToCopy?: string) => void)"}},onThreatListView:{defaultValue:null,description:"",name:"onThreatListView",required:!1,type:{name:"((filter?: ThreatStatementListFilter) => void)"}},onMitigationListView:{defaultValue:null,description:"",name:"onMitigationListView",required:!1,type:{name:"((filter?: MitigationListFilter) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/workspaces/WorkspaceInsights/index.tsx#WorkspaceInsights"]={docgenInfo:WorkspaceInsights.__docgenInfo,name:"WorkspaceInsights",path:"src/components/workspaces/WorkspaceInsights/index.tsx#WorkspaceInsights"})}catch(__react_docgen_typescript_loader_error){}}}]);